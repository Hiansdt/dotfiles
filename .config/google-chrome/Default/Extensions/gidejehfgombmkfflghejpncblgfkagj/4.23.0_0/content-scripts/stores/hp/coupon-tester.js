(()=>{var e={53012:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCacheExpired=void 0;t.isCacheExpired=(e=0)=>new Date>new Date(e)},38871:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionStorage=void 0;const o=r(n(3141)),i=n(53012),a=n(22452);t.ExtensionStorage=class{constructor(e){this.get=async e=>{var t;return null!==(t=(await chrome.storage[this.cacheType].get(e))[e])&&void 0!==t?t:null},this.getValid=async e=>{const t=await this.get(e);return t&&!(0,i.isCacheExpired)(t.timeToExpire)?t:null},this.set=async({key:e,value:t,timeToExpire:n,eTag:r})=>{const o={};o[e]={value:t,timeToExpire:n},r&&(o[e].eTag=r),await chrome.storage[this.cacheType].set(o)},this.delete=async e=>{await chrome.storage[this.cacheType].remove(e)},this.handleRequestUsingCache=async({uniqueKey:e,requestUrl:t,expirationInMilliseconds:n,options:r,retry:s})=>{const c=await this.get(e);if(c&&!(0,i.isCacheExpired)(c.timeToExpire))return c.value;const u=(new Date).getTime()+(n||3e5);let l={"Cache-Control":"no-cache"};(null==c?void 0:c.eTag)&&(l["If-None-Match"]=c.eTag),r&&(l={...l,...r});return await o.default.request({uniqueKey:e,requestUrl:t,options:{method:"get",headers:l}}).then((t=>this.handleResponse(e,t,c,u))).catch((async()=>!s||s.attempts<=0?{}:(await a.TimerHelper.waitDelay(s.delayInMs),this.handleRequestUsingCache({uniqueKey:e,requestUrl:t,expirationInMilliseconds:n,options:r,retry:{attempts:s.attempts-1,delayInMs:2*s.delayInMs}}))))},this.handleResponse=async(e,t,n,r)=>{var o,i,a;const s=!t||t instanceof Error,c=(null==t?void 0:t.status)>=400||(null==t?void 0:t.status)<200;if(s||c)throw new Error(`Server error: ${null!==(o=null==t?void 0:t.status)&&void 0!==o?o:500}`);const u=null!==(i=t.headers.get("ETag"))&&void 0!==i?i:void 0;if(!(!u||!(null==n?void 0:n.eTag)||u!==n.eTag))return this.set({key:e,value:null!==(a=n.value)&&void 0!==a?a:n,timeToExpire:r,eTag:u}),n.value;const l=await t.clone().json();return this.set({key:e,value:l,timeToExpire:r,eTag:u}),l},this.cacheType=e}}},22452:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimerHelper=void 0;class n{}t.TimerHelper=n,n.waitDelay=async e=>{await new Promise((t=>setTimeout((()=>t(null)),e)))}},18731:(e,t,n)=>{"use strict";t.wS=void 0;const r=n(38871);t.wS=new r.ExtensionStorage("local"),new r.ExtensionStorage("session")},3141:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=new class{constructor(){this.cache={}}request({uniqueKey:e,requestUrl:t,options:n}){return e?(e in this.cache||(this.cache[e]=fetch(t,n).then((e=>{if(e.status<200||e.status>399)throw{message:`Response status error: ${e.status}`,status:e.status};return e})).catch((e=>e)).finally((()=>{delete this.cache[e]}))),this.cache[e]):Promise.reject(new Error("Unique key not passed"))}}},83957:(e,t,n)=>{e.exports=n(68475)},58404:(e,t,n)=>{"use strict";var r=n(92952),o=n(43366),i=n(72134),a=n(81587),s=n(56648),c=n(7238),u=n(44447);e.exports=function(e){return new Promise((function(t,l){var _=e.data,d=e.headers;r.isFormData(_)&&delete d["Content-Type"];var f=new XMLHttpRequest;if(e.auth){var h=e.auth.username||"",p=e.auth.password||"";d.Authorization="Basic "+btoa(h+":"+p)}var g=a(e.baseURL,e.url);if(f.open(e.method.toUpperCase(),i(g,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,f.onreadystatechange=function(){if(f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in f?s(f.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:n,config:e,request:f};o(t,l,r),f=null}},f.onabort=function(){f&&(l(u("Request aborted",e,"ECONNABORTED",f)),f=null)},f.onerror=function(){l(u("Network Error",e,null,f)),f=null},f.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),l(u(t,e,"ECONNABORTED",f)),f=null},r.isStandardBrowserEnv()){var m=n(67048),b=(e.withCredentials||c(g))&&e.xsrfCookieName?m.read(e.xsrfCookieName):void 0;b&&(d[e.xsrfHeaderName]=b)}if("setRequestHeader"in f&&r.forEach(d,(function(e,t){void 0===_&&"content-type"===t.toLowerCase()?delete d[t]:f.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(f.withCredentials=!!e.withCredentials),e.responseType)try{f.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&f.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){f&&(f.abort(),l(e),f=null)})),void 0===_&&(_=null),f.send(_)}))}},68475:(e,t,n)=>{"use strict";var r=n(92952),o=n(22096),i=n(27359),a=n(36867);function s(e){var t=new i(e),n=o(i.prototype.request,t);return r.extend(n,i.prototype,t),r.extend(n,t),n}var c=s(n(63527));c.Axios=i,c.create=function(e){return s(a(c.defaults,e))},c.Cancel=n(31972),c.CancelToken=n(97723),c.isCancel=n(9860),c.all=function(e){return Promise.all(e)},c.spread=n(82696),e.exports=c,e.exports.default=c},31972:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},97723:(e,t,n)=>{"use strict";var r=n(31972);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o((function(t){e=t})),cancel:e}},e.exports=o},9860:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},27359:(e,t,n)=>{"use strict";var r=n(92952),o=n(72134),i=n(14667),a=n(39310),s=n(36867);function c(e){this.defaults=e,this.interceptors={request:new i,response:new i}}c.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=s(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[a,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},c.prototype.getUri=function(e){return e=s(this.defaults,e),o(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){c.prototype[e]=function(t,n){return this.request(r.merge(n||{},{method:e,url:t}))}})),r.forEach(["post","put","patch"],(function(e){c.prototype[e]=function(t,n,o){return this.request(r.merge(o||{},{method:e,url:t,data:n}))}})),e.exports=c},14667:(e,t,n)=>{"use strict";var r=n(92952);function o(){this.handlers=[]}o.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=o},81587:(e,t,n)=>{"use strict";var r=n(67261),o=n(63756);e.exports=function(e,t){return e&&!r(t)?o(e,t):t}},44447:(e,t,n)=>{"use strict";var r=n(26965);e.exports=function(e,t,n,o,i){var a=new Error(e);return r(a,t,n,o,i)}},39310:(e,t,n)=>{"use strict";var r=n(92952),o=n(72381),i=n(9860),a=n(63527);function s(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return s(e),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return s(e),t.data=o(t.data,t.headers,e.transformResponse),t}),(function(t){return i(t)||(s(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},26965:e=>{"use strict";e.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},36867:(e,t,n)=>{"use strict";var r=n(92952);e.exports=function(e,t){t=t||{};var n={},o=["url","method","params","data"],i=["headers","auth","proxy"],a=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];r.forEach(o,(function(e){void 0!==t[e]&&(n[e]=t[e])})),r.forEach(i,(function(o){r.isObject(t[o])?n[o]=r.deepMerge(e[o],t[o]):void 0!==t[o]?n[o]=t[o]:r.isObject(e[o])?n[o]=r.deepMerge(e[o]):void 0!==e[o]&&(n[o]=e[o])})),r.forEach(a,(function(r){void 0!==t[r]?n[r]=t[r]:void 0!==e[r]&&(n[r]=e[r])}));var s=o.concat(i).concat(a),c=Object.keys(t).filter((function(e){return-1===s.indexOf(e)}));return r.forEach(c,(function(r){void 0!==t[r]?n[r]=t[r]:void 0!==e[r]&&(n[r]=e[r])})),n}},43366:(e,t,n)=>{"use strict";var r=n(44447);e.exports=function(e,t,n){var o=n.config.validateStatus;!o||o(n.status)?e(n):t(r("Request failed with status code "+n.status,n.config,null,n.request,n))}},72381:(e,t,n)=>{"use strict";var r=n(92952);e.exports=function(e,t,n){return r.forEach(n,(function(n){e=n(e,t)})),e}},63527:(e,t,n)=>{"use strict";var r=n(88538),o=n(92952),i=n(8646),a={"Content-Type":"application/x-www-form-urlencoded"};function s(e,t){!o.isUndefined(e)&&o.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var c,u={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==r&&"[object process]"===Object.prototype.toString.call(r))&&(c=n(58404)),c),transformRequest:[function(e,t){return i(t,"Accept"),i(t,"Content-Type"),o.isFormData(e)||o.isArrayBuffer(e)||o.isBuffer(e)||o.isStream(e)||o.isFile(e)||o.isBlob(e)?e:o.isArrayBufferView(e)?e.buffer:o.isURLSearchParams(e)?(s(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):o.isObject(e)?(s(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},o.forEach(["delete","get","head"],(function(e){u.headers[e]={}})),o.forEach(["post","put","patch"],(function(e){u.headers[e]=o.merge(a)})),e.exports=u},22096:e=>{"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},72134:(e,t,n)=>{"use strict";var r=n(92952);function o(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var i;if(n)i=n(t);else if(r.isURLSearchParams(t))i=t.toString();else{var a=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),a.push(o(t)+"="+o(e))})))})),i=a.join("&")}if(i){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}},63756:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},67048:(e,t,n)=>{"use strict";var r=n(92952);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,o,i,a){var s=[];s.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(o)&&s.push("path="+o),r.isString(i)&&s.push("domain="+i),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},67261:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},7238:(e,t,n)=>{"use strict";var r=n(92952);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=o(window.location.href),function(t){var n=r.isString(t)?o(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},8646:(e,t,n)=>{"use strict";var r=n(92952);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},56648:(e,t,n)=>{"use strict";var r=n(92952),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,i,a={};return e?(r.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=r.trim(e.substr(0,i)).toLowerCase(),n=r.trim(e.substr(i+1)),t){if(a[t]&&o.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([n]):a[t]?a[t]+", "+n:n}})),a):a}},82696:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},92952:(e,t,n)=>{"use strict";var r=n(22096),o=Object.prototype.toString;function i(e){return"[object Array]"===o.call(e)}function a(e){return void 0===e}function s(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===o.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),i(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:i,isArrayBuffer:function(e){return"[object ArrayBuffer]"===o.call(e)},isBuffer:function(e){return null!==e&&!a(e)&&null!==e.constructor&&!a(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isUndefined:a,isDate:function(e){return"[object Date]"===o.call(e)},isFile:function(e){return"[object File]"===o.call(e)},isBlob:function(e){return"[object Blob]"===o.call(e)},isFunction:c,isStream:function(e){return s(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:u,merge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]=n}for(var r=0,o=arguments.length;r<o;r++)u(arguments[r],n);return t},deepMerge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]="object"==typeof n?e({},n):n}for(var r=0,o=arguments.length;r<o;r++)u(arguments[r],n);return t},extend:function(e,t,n){return u(t,(function(t,o){e[o]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},86636:function(e){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=90)}({17:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=n(18),o=function(){function e(){}return e.getFirstMatch=function(e,t){var n=t.match(e);return n&&n.length>0&&n[1]||""},e.getSecondMatch=function(e,t){var n=t.match(e);return n&&n.length>1&&n[2]||""},e.matchAndReturnConst=function(e,t,n){if(e.test(t))return n},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,n,r){void 0===r&&(r=!1);var o=e.getVersionPrecision(t),i=e.getVersionPrecision(n),a=Math.max(o,i),s=0,c=e.map([t,n],(function(t){var n=a-e.getVersionPrecision(t),r=t+new Array(n+1).join(".0");return e.map(r.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(r&&(s=a-Math.min(o,i)),a-=1;a>=s;){if(c[0][a]>c[1][a])return 1;if(c[0][a]===c[1][a]){if(a===s)return 0;a-=1}else if(c[0][a]<c[1][a])return-1}},e.map=function(e,t){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n+=1)r.push(t(e[n]));return r},e.find=function(e,t){var n,r;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(n=0,r=e.length;n<r;n+=1){var o=e[n];if(t(o,n))return o}},e.assign=function(e){for(var t,n,r=e,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];if(Object.assign)return Object.assign.apply(Object,[e].concat(i));var s=function(){var e=i[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){r[t]=e[t]}))};for(t=0,n=i.length;t<n;t+=1)s();return e},e.getBrowserAlias=function(e){return r.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return r.BROWSER_MAP[e]||""},e}();t.default=o,e.exports=t.default},18:function(e,t,n){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,o=(r=n(91))&&r.__esModule?r:{default:r},i=n(18);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){}var t,n,r;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new o.default(e,t)},e.parse=function(e){return new o.default(e).getResult()},t=e,r=[{key:"BROWSER_MAP",get:function(){return i.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return i.ENGINE_MAP}},{key:"OS_MAP",get:function(){return i.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return i.PLATFORMS_MAP}}],(n=null)&&a(t.prototype,n),r&&a(t,r),e}();t.default=s,e.exports=t.default},91:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=c(n(92)),o=c(n(93)),i=c(n(94)),a=c(n(95)),s=c(n(17));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=s.default.find(r.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=s.default.find(o.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=s.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=s.default.find(a.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return s.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,n={},r=0,o={},i=0;if(Object.keys(e).forEach((function(t){var a=e[t];"string"==typeof a?(o[t]=a,i+=1):"object"==typeof a&&(n[t]=a,r+=1)})),r>0){var a=Object.keys(n),c=s.default.find(a,(function(e){return t.isOS(e)}));if(c){var u=this.satisfies(n[c]);if(void 0!==u)return u}var l=s.default.find(a,(function(e){return t.isPlatform(e)}));if(l){var _=this.satisfies(n[l]);if(void 0!==_)return _}}if(i>0){var d=Object.keys(o),f=s.default.find(d,(function(e){return t.isBrowser(e,!0)}));if(void 0!==f)return this.compareVersion(o[f])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var n=this.getBrowserName().toLowerCase(),r=e.toLowerCase(),o=s.default.getBrowserTypeByAlias(r);return t&&o&&(r=o.toLowerCase()),r===n},t.compareVersion=function(e){var t=[0],n=e,r=!1,o=this.getBrowserVersion();if("string"==typeof o)return">"===e[0]||"<"===e[0]?(n=e.substr(1),"="===e[1]?(r=!0,n=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?n=e.substr(1):"~"===e[0]&&(r=!0,n=e.substr(1)),t.indexOf(s.default.compareVersions(o,n,r))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=u,e.exports=t.default},92:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,o=(r=n(17))&&r.__esModule?r:{default:r},i=/version\/(\d+(\.?_?\d+)+)/i,a=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},n=o.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},n=o.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},n=o.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},n=o.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},n=o.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},n=o.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},n=o.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},n=o.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},n=o.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},n=o.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},n=o.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},n=o.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},n=o.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},n=o.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},n=o.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return n&&(t.version=n),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},n=o.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},n=o.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},n=o.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},n=o.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},n=o.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},n=o.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},n=o.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},n=o.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},n=o.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},n=o.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},n=o.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},n=o.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t={name:"Android Browser"},n=o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},n=o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},n=o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:o.default.getFirstMatch(t,e),version:o.default.getSecondMatch(t,e)}}}];t.default=a,e.exports=t.default},93:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,o=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),a=[{test:[/Roku\/DVP/],describe:function(e){var t=o.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:i.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=o.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=o.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),n=o.default.getWindowsVersionName(t);return{name:i.OS_MAP.Windows,version:t,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:i.OS_MAP.iOS},n=o.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return n&&(t.version=n),t}},{test:[/macintosh/i],describe:function(e){var t=o.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),n=o.default.getMacOSVersionName(t),r={name:i.OS_MAP.MacOS,version:t};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=o.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:i.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t=o.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),n=o.default.getAndroidVersionName(t),r={name:i.OS_MAP.Android,version:t};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=o.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),n={name:i.OS_MAP.WebOS};return t&&t.length&&(n.version=t),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=o.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||o.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||o.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:i.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=o.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=o.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:i.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:i.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=o.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.PlayStation4,version:t}}}];t.default=a,e.exports=t.default},94:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,o=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),a=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=o.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",n={type:i.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(n.model=t),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),n=e.test(/like (ipod|iphone)/i);return t&&!n},describe:function(e){var t=o.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:i.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:i.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.tv}}}];t.default=a,e.exports=t.default},95:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,o=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),a=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:i.ENGINE_MAP.Blink};var t=o.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:i.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:i.ENGINE_MAP.Trident},n=o.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:i.ENGINE_MAP.Presto},n=o.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=e.test(/gecko/i),n=e.test(/like gecko/i);return t&&!n},describe:function(e){var t={name:i.ENGINE_MAP.Gecko},n=o.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:i.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:i.ENGINE_MAP.WebKit},n=o.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}}];t.default=a,e.exports=t.default}})},88538:e=>{var t,n,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(e){n=i}}();var s,c=[],u=!1,l=-1;function _(){u&&s&&(u=!1,s.length?c=s.concat(c):l=-1,c.length&&d())}function d(){if(!u){var e=a(_);u=!0;for(var t=c.length;t;){for(s=c,c=[];++l<t;)s&&s[l].run();l=-1,t=c.length}s=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function h(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new f(e,t)),1!==c.length||u||a(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=h,r.addListener=h,r.once=h,r.off=h,r.removeListener=h,r.removeAllListeners=h,r.emit=h,r.prependListener=h,r.prependOnceListener=h,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=!1;let t={query:function(e,t){chrome.tabs.query(e,(e=>this.callbackHelper("query",e,t)))},get:function(e,t){chrome.tabs.get(e,(e=>this.callbackHelper("get",e,t)))},getAsync:function(e){return new Promise((t=>this.get(e,t)))},executeInAllTabs:function(e,t,n){this.query(e,(function(e){e.forEach((e=>{t(e)})),void 0!==n&&n()}))},sendMessageTab:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n||(n=()=>{const e=chrome.runtime.lastError;void 0!==e&&_("development")&&console.log(e.message)}),chrome.tabs.sendMessage(e,t,n)},sendMessage:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};r.request=t,r.response=n,this.sendMessageTab(e,r)},createTabAsync:function(e){return new Promise(((t,n)=>{chrome.tabs.create(e,(e=>{chrome.runtime.lastError?n(new Error(chrome.runtime.lastError)):t(e)}))}))},createTab:function(e,t,n){chrome.tabs.create({url:e,active:t},n)},executeScriptFile:function(e,t,n){chrome.scripting.executeScript({target:{tabId:e},files:[t]},(e=>this.callbackHelper("executeScriptFile",e,n)))},executeScript:function(e,t,n,r){chrome.scripting.executeScript({target:{tabId:e},func:t,args:n},(e=>this.callbackHelper("executeScript",e,r)))},reloadTab:function(e){chrome.tabs.reload(e)},executeContentScript:function(e,t,n){chrome.scripting.executeScript({target:{tabId:e},files:[`content-scripts/${t}`]},(e=>this.callbackHelper("executeContentScript",e,n)))},insertCSS:function(e,t,n){chrome.scripting.insertCSS({target:{tabId:e},files:[t]},(e=>this.callbackHelper("insertCSS",e,n)))},setTitleFaviconLoadingTab:function(e){let t=chrome.runtime.getURL(chrome.runtime.getManifest().icons[128]);this.sendMessageTab(e,{text:"set_favicon_loading_tab",data:{favicon:t}})},onActivated:function(e){chrome.tabs.onActivated.addListener(e)},onCreated:function(e){chrome.tabs.onCreated.addListener(e)},onUpdated:function(e){chrome.tabs.onUpdated.addListener(e)},onRemoved:function(e){chrome.tabs.onRemoved.addListener(e)},isTabLoaded:function(e){return e&&"complete"===e.status},getCurrentTab:function(e){chrome.tabs.query({currentWindow:!0,active:!0},(t=>this.callbackHelper("getCurrentTab",t[0],e)))},getCurrentTabAsync:function(){return new Promise((e=>this.getCurrentTab(e)))},remove:function(e,t){chrome.tabs.remove(e,t)},waitPageCompleteLoaded:async function(e){if(this.isTabLoaded(e))return new Promise((e=>e()));const t=await _("generalHelper").getSetting("timeLimitToAwaitTabLoad");return new Promise((n=>{const r=setTimeout((()=>{n(),chrome.tabs.onUpdated.removeListener(o)}),t),o=(t,i,a)=>{e.id==t&&this.isTabLoaded(a)&&(clearTimeout(r),chrome.tabs.onUpdated.removeListener(o),n())};chrome.tabs.onUpdated.addListener(o)}))},callbackHelper(e,t,n){let r=chrome.runtime.lastError;void 0!==r?_("development")&&console.log(`${e}: ${r.message}`):n&&n(t)}};const r=t;function o(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var i=null;function a(){if(null===i){let e=o();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),i=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return i}function s(){let e=o();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function c(){let e=a(),t=s(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=o();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var u="__INTENTIONAL_UNDEFINED__";let l={};function _(t){let n=c();if(void 0===n[t])return function(t){switch(t){case"development":return e;case"generalHelper":return po}return}(t);var r=n[t];return r===u?void 0:r}function d(e,t){let n=c();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){f(e)}))}):(n[e]=void 0===t?u:t,function(){f(e)})}function f(e){let t=c();delete t[e],0==Object.keys(t).length&&delete s()[a]}function h(e){let t=c();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(l,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",_),e("__GetDependency__",_),e("__Rewire__",d),e("__set__",d),e("__reset__",f),e("__ResetDependency__",f),e("__with__",h)}();function p(e,n){Object.defineProperty(t,e,{value:n,enumerable:!1,configurable:!0})}Object.isExtensible(t)&&(p("__get__",_),p("__GetDependency__",_),p("__Rewire__",d),p("__set__",d),p("__reset__",f),p("__ResetDependency__",f),p("__with__",h),p("__RewireAPI__",l));var g=n(18731);let m={add:function(e,t,n){var r={};r[e]=t,chrome.storage.local.set(r,(function(){chrome.runtime.lastError&&console.log("error on retrieving from local storage");const t={status:!0,data:r[e],message:`O item ${e} foi adicionado.`};n&&n(t)}))},get:function(e,t){chrome.storage.local.get(e,(function(e){chrome.runtime.lastError&&console.log("error on retrieving from local storage");const n=Object.keys(e).length>0?{exist:!0,data:e}:{exist:!1,data:null};t&&t(n)}))},getAsync:function(e){return new Promise((t=>{chrome.storage.local.get(e,(n=>{t(n[e]??null)}))}))},addSync:function(e,t,n){var r={};r[e]=t,chrome.storage.sync.set(r,(function(){chrome.runtime.lastError&&console.log("error on retrieving from sync storage");const t={status:!0,data:r[e],message:`O item ${e} foi adicionado.`};n&&n(t)}))},getSync:function(e,t){chrome.storage.sync.get(e,(function(e){chrome.runtime.lastError&&console.log("error on retrieving from sync storage");const n=Object.keys(e).length>0?{exist:!0,data:e}:{exist:!1,data:null};t&&t(n)}))},getAll:function(){return new Promise((e=>{chrome.storage.local.get(null,(function(t){var n=Object.keys(t);e(n)}))}))},remove:function(e,t){chrome.storage.local.remove(e,(function(){chrome.runtime.lastError&&console.log("error on retrieving from local storage");t&&t({status:!0,message:`O item ${e} foi removido.`})}))},removeAsync:function(e){return new Promise((t=>{chrome.storage.local.remove(e,(()=>{t(null)}))}))},addCache(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;return new Promise(((r,o)=>{if(!e||!n)return o(new Error("key or expire time not undefined"));var i={value:t,expiresAt:(new Date).getTime()+n};this.add(e.toString(),i,(e=>r(e)))}))},addCacheEtag(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new Promise(((o,i)=>{if(!e||!n)return i(new Error("key or expire time not undefined"));var a={value:t,etag:r,caches_until:(new Date).getTime()+n};this.add(e.toString(),a,(e=>o(e)))}))},async getCacheEtag(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const{config:o}=await chrome.storage.local.get("config"),{requestCacheLibRetry:i}=(null==o?void 0:o.value)||{};let a=null;return i&&i.enabled&&(a={attempts:i.attempts??0,delayInMs:i.delayInMs??0}),C("extensionLocalStorage").handleRequestUsingCache({uniqueKey:e,requestUrl:t,expirationInMilliseconds:n,options:r,retry:a})},getValid:e=>C("extensionLocalStorage").getValid(e),set:(e,t,n,r)=>C("extensionLocalStorage").set({key:e,value:t,timeToExpire:n,eTag:r}),setSetting(e,t){return new Promise((n=>{this.get("settings",(r=>{var o;let i=(null===(o=r.data)||void 0===o?void 0:o.settings)||{};i[e]=t,this.add("settings",i,(()=>n()))}))}))},getSetting(e){return new Promise((t=>{this.get("settings",(n=>{if(!n.exist)return t(null);t(n.data.settings[e]??null)}))}))},getCache(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise((n=>{chrome.storage.local.get(e.toString(),(r=>{if(Object.keys(r).length>0){let o=r[e];if((null==o?void 0:o.expiresAt)>(new Date).getTime())return n(o.value??o);if(!t)return n();this.remove(e)}n(null)}))}))},updateCache(e,t){return new Promise((n=>{chrome.storage.local.get(e.toString(),(r=>{if(Object.keys(r).length>0){let o=r[e],i={value:t,expiresAt:o.expiresAt};this.add(e.toString(),i,(e=>n(e)))}}))}))},getSession:async e=>chrome.storage.session.get(e).then((t=>t[e])),addSession(e,t,n){const r={};r[e]=n?{value:t,expiresAt:(new Date).getTime()+n}:t,chrome.storage.session.set(r)},removeSession(e){chrome.storage.session.remove(e)},async addStoreToPaymentTracker(e,t){let n=await this.getSession("payment_tracker"),r={};n&&Object.keys(t).length&&(r=n),r[t]||(r[t]=""),r[t].includes(e)||(r[t]=e),this.addSession("payment_tracker",r)},async getStorePaymentType(e){return new Promise((t=>{this.getSession("payment_tracker").then((n=>t(null==n?void 0:n[e])))}))},async removeStorePaymentType(e){let t=await this.getSession("payment_tracker");t[e]&&delete t[e],this.addSession("payment_tracker",t)},async addStoreToRememberList(e,t){let n=await this.getSession("remember"),r={};n&&Object.keys(n).length&&(r=n),r[e]||(r[e]=[]),r[e].includes(t)||r[e].push(t),this.addSession("remember",r)},storeExistOnRememberList(e,t){return new Promise((n=>{this.storesFromRememberList(e,(async e=>{n(e&&e.includes(t))}))}))},removeStoreFromRememberList(e,t){this.storesFromRememberList(e,(async n=>{if(!n)return;n.splice(n.indexOf(t),1);let r=await this.getSession("remember"),o={};r&&Object.keys(r).length&&(o=r),o[e]=n,this.addSession("remember",o)}))},async storesFromRememberList(e,t){let n=await this.getSession("remember");return t(null==n?void 0:n[e])},async removeKeySession(e,t){let n=await this.getSession("remember");n[e].includes(t)&&delete n[e],this.addSession("remember",n)},async isSessionKeyValid(e){let t=await this.getSession(e);return t&&t.expiresAt>(new Date).getTime()},getAllAndFilterByKey:async e=>new Promise((t=>{chrome.storage.local.get(null,(n=>{const r=Object.entries(n).filter((t=>{let[n,r]=t;return n.startsWith(e)&&r.value.hasVisited})).map((e=>{let[,t]=e;return{...t.value}}));t(r)}))})),getLocalStorage:async()=>new Promise((e=>{chrome.storage.local.get(null,(t=>{e(t)}))})),async removeStoreCaches(e){const t=await this.getLocalStorage(),n=Object.keys(t).reduce(((t,n)=>(e.find((e=>n===`cache_${e}`||n===`cache_${e}_core`))&&t.push(n),t)),[]);return this.remove(n),null}};const b=m;function v(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var E=null;function y(){if(null===E){let e=v();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),E=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return E}function w(){let e=v();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function R(){let e=y(),t=w(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=v();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var T="__INTENTIONAL_UNDEFINED__";let O={};function C(e){let t=R();if(void 0===t[e])return function(e){if("extensionLocalStorage"===e)return g.wS;return}(e);var n=t[e];return n===T?void 0:n}function I(e,t){let n=R();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){L(e)}))}):(n[e]=void 0===t?T:t,function(){L(e)})}function L(e){let t=R();delete t[e],0==Object.keys(t).length&&delete w()[y]}function S(e){let t=R();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(O,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",C),e("__GetDependency__",C),e("__Rewire__",I),e("__set__",I),e("__reset__",L),e("__ResetDependency__",L),e("__with__",S)}();function A(e,t){Object.defineProperty(m,e,{value:t,enumerable:!1,configurable:!0})}Object.isExtensible(m)&&(A("__get__",C),A("__GetDependency__",C),A("__Rewire__",I),A("__set__",I),A("__reset__",L),A("__ResetDependency__",L),A("__with__",S),A("__RewireAPI__",O));var k=n(83957),D=n.n(k);function M(){return(new Date).toLocaleDateString("pt-BR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric"})}Date.prototype.addDays=function(e){const t=new Date(this.valueOf());return t.setDate(t.getDate()+e),t};const $=(e,t)=>!(!e||!t)&&new Date(e)>new Date(t),P=e=>Math.floor(e/36e5),j=e=>Math.floor(e%36e5/6e4),B=e=>Math.floor(e%6e4/1e3),G=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate();function N(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var x=null;function U(){if(null===x){let e=N();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),x=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return x}function F(){let e=N();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function W(){let e=U(),t=F(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=N();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var H="__INTENTIONAL_UNDEFINED__";let V={};function Y(e){let t=W();if(void 0===t[e])return function(e){switch(e){case"getHourByTimeInMs":return P;case"getMinutesByTimeInMs":return j;case"getSecondsByTimeInMs":return B}return}(e);var n=t[e];return n===H?void 0:n}function q(e,t){let n=W();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){X(e)}))}):(n[e]=void 0===t?H:t,function(){X(e)})}function X(e){let t=W();delete t[e],0==Object.keys(t).length&&delete F()[U]}function z(e){let t=W();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(V,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",Y),e("__GetDependency__",Y),e("__Rewire__",q),e("__set__",q),e("__reset__",X),e("__ResetDependency__",X),e("__with__",z)}();class Q{constructor(e){this.baseUrl=e}async getData(){return await ae("db").getCacheEtag("data",`${this.baseUrl}data.json`,await ae("generalHelper").getCache("data"))||{}}async getNotificationsWhitelist(){return await ae("db").getCacheEtag("notifications-whitelist",`${this.baseUrl}notifications-whitelist.json`,await ae("generalHelper").getCache("notifications-whitelist"))||[]}async getThankYouStores(){return await ae("db").getCacheEtag("thankyou",`${this.baseUrl}thankyou.json`,await ae("generalHelper").getCache("thankyou"))||[]}async getHosts(){const e=`${this.baseUrl}hosts.json`,t=await ae("generalHelper").getCache("hosts");let n={};try{n=await ae("db").getCacheEtag("hosts",e,t)}catch(e){console.log("Error getting hosts",e)}return n}async getCouponTester(){return await ae("db").getCacheEtag("coupon-tester",`${this.baseUrl}coupon-tester.json`,await ae("generalHelper").getCache("coupon-tester"))||[]}async getGenericCoupons(){return await ae("db").getCacheEtag("coupons",`${this.baseUrl}coupons.json`,await ae("generalHelper").getCache("coupons"))||[]}async getPopupConfig(){return await ae("db").getCacheEtag("popup",`${this.baseUrl}popup.json`,await ae("generalHelper").getCache("popup"))||{}}async getSimilarProduct(){return await ae("db").getCacheEtag("similar-products",`${this.baseUrl}similar-products.json`,await ae("generalHelper").getCache("similar-products"))||[]}async getCompetitors(){return await ae("db").getCacheEtag("competitors",`${this.baseUrl}competitors.json`,await ae("generalHelper").getCache("competitors"))||[]}async getExtensions(){return await ae("db").getCacheEtag("extensions",`${this.baseUrl}extensions.json`,await ae("generalHelper").getCache("extensions"))||[]}async getExtensionConfig(){return await ae("db").getCacheEtag("config",`${this.baseUrl}config.json`,36e5)||{}}async getStoreRelations(){return await ae("db").getCacheEtag("store-relations",`${this.baseUrl}store-relations.json`,await ae("generalHelper").getCache("store-relations"))||[]}async getJSON(e){const t=await ae("generalHelper").getCache(e),n=`${this.baseUrl}${e}.json`;return await ae("db").getCacheEtag(e,n,t)||{}}async getContentScript(e){return await ae("db").getCacheEtag(`content-scripts/${e}`,`content-scripts/${e}`,await ae("generalHelper").getCache("content-scripts-files"))||""}async getWarnings(){return await ae("db").getCacheEtag("warnings",`${this.baseUrl}warnings.json`,await ae("generalHelper").getCache("warnings"))||[]}isInvalidJSON(e){const t=e.headers["content-type"].includes("application/json"),n="string"==typeof e.data;return t&&n}async sendPurchase(e,t){let n={data:e,cookies:await ae("generalHelper").getTrackingData(t),dateTime:ae("getDateTime")()};ae("axios").post("https://qi1uazf5s1.execute-api.us-east-1.amazonaws.com/Prod/extension-information",n).finally((()=>{}))}async getBanners(){const e=await ae("db").getCacheEtag("banners",`${this.baseUrl}banners.json`,await ae("generalHelper").getCache("banners")),t=0===Object.keys(e||{}).length;if(!e||t)return[];const{banners:n=[]}=e;return n.filter((e=>{const t=ae("isFirstAfterSecondDate")(new Date,new Date(e.startDate)),n=ae("isFirstAfterSecondDate")(new Date(e.endDate),new Date);return t&&n}))}}let K=new(ae("AmazonRestClient"))("https://d2iv4x4t7ozxv2.cloudfront.net/");const J=K;function Z(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var ee=null;function te(){if(null===ee){let e=Z();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),ee=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return ee}function ne(){let e=Z();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function re(){let e=te(),t=ne(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=Z();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var oe="__INTENTIONAL_UNDEFINED__";let ie={};function ae(e){let t=re();if(void 0===t[e])return function(e){switch(e){case"db":return b;case"generalHelper":return po;case"getDateTime":return M;case"axios":return D();case"isFirstAfterSecondDate":return $;case"AmazonRestClient":return Q}return}(e);var n=t[e];return n===oe?void 0:n}function se(e,t){let n=re();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){ce(e)}))}):(n[e]=void 0===t?oe:t,function(){ce(e)})}function ce(e){let t=re();delete t[e],0==Object.keys(t).length&&delete ne()[te]}function ue(e){let t=re();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(ie,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",ae),e("__GetDependency__",ae),e("__Rewire__",se),e("__set__",se),e("__reset__",ce),e("__ResetDependency__",ce),e("__with__",ue)}();let le=typeof K;function _e(e,t){Object.defineProperty(K,e,{value:t,enumerable:!1,configurable:!0})}"object"!==le&&"function"!==le||!Object.isExtensible(K)||(_e("__get__",ae),_e("__GetDependency__",ae),_e("__Rewire__",se),_e("__set__",se),_e("__reset__",ce),_e("__ResetDependency__",ce),_e("__with__",ue),_e("__RewireAPI__",ie));class de{constructor(e){this.baseURL=e}saveEventWith(e){fetch(this.baseURL+"/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e})}}let fe=new(we("EventsRestClient"))("https://05u19b337b.execute-api.us-east-1.amazonaws.com/prod/e");const he=fe;function pe(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var ge=null;function me(){if(null===ge){let e=pe();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),ge=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return ge}function be(){let e=pe();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function ve(){let e=me(),t=be(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=pe();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Ee="__INTENTIONAL_UNDEFINED__";let ye={};function we(e){let t=ve();if(void 0===t[e])return function(e){if("EventsRestClient"===e)return de;return}(e);var n=t[e];return n===Ee?void 0:n}function Re(e,t){let n=ve();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){Te(e)}))}):(n[e]=void 0===t?Ee:t,function(){Te(e)})}function Te(e){let t=ve();delete t[e],0==Object.keys(t).length&&delete be()[me]}function Oe(e){let t=ve();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(ye,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",we),e("__GetDependency__",we),e("__Rewire__",Re),e("__set__",Re),e("__reset__",Te),e("__ResetDependency__",Te),e("__with__",Oe)}();let Ce=typeof fe;function Ie(e,t){Object.defineProperty(fe,e,{value:t,enumerable:!1,configurable:!0})}"object"!==Ce&&"function"!==Ce||!Object.isExtensible(fe)||(Ie("__get__",we),Ie("__GetDependency__",we),Ie("__Rewire__",Re),Ie("__set__",Re),Ie("__reset__",Te),Ie("__ResetDependency__",Te),Ie("__with__",Oe),Ie("__RewireAPI__",ye));let Le={signInWithStore:function(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"cuponomia.com.br";return new Promise((i=>{const a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Be("tabHelper").executeInAllTabs({url:n+"/*"},(n=>Be("tabHelper").sendMessage(n.id,e,null,{...t,group:"auth",originTabId:r})))};Be("tabHelper").createTab(e,t,(e=>{function t(n,r,o){e.id!==n&&"complete"!==r.status||(Be("tabHelper").remove(n),chrome.tabs.onUpdated.removeListener(t))}a("initialize",{authTabId:e.id}),chrome.tabs.onUpdated.addListener((function n(r,i,a){i.title||e.id!==r||a.url.indexOf(o)>-1||(chrome.tabs.onUpdated.removeListener(n),chrome.tabs.onUpdated.addListener(t))})),chrome.tabs.onRemoved.addListener((t=>{e.id===t&&(r&&chrome.tabs.update(r,{active:!0}),a("finish"),i())}))}))}))},getUser:function(){let e={domain:new URL("https://www.cuponomia.com.br/").host};return new Promise(((t,n)=>{chrome.cookies.getAll(e,(e=>{let n=null,r=e.filter((e=>!e.domain.includes("admin")&&"e"===e.name));r.length&&(n=r.shift().value),t(n)}))}))},isUserAuthenticated:function(){let e={domain:new URL("https://www.cuponomia.com.br/").host};return new Promise(((t,n)=>{chrome.cookies.getAll(e,(e=>{let n=e.filter((e=>!e.domain.includes("admin")&&"accessToken"===e.name));t(!!n.length)}))}))},getUuid:function(){let e={domain:new URL("https://www.cuponomia.com.br/").host};return new Promise(((t,n)=>{chrome.cookies.getAll(e,(e=>{let n=null,r=e.filter((e=>!e.domain.includes("admin")&&"uuid"===e.name));r.length&&(n=r.shift().value),t(n)}))}))}};const Se=Le;function Ae(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var ke=null;function De(){if(null===ke){let e=Ae();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),ke=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return ke}function Me(){let e=Ae();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function $e(){let e=De(),t=Me(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=Ae();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Pe="__INTENTIONAL_UNDEFINED__";let je={};function Be(e){let t=$e();if(void 0===t[e])return function(e){if("tabHelper"===e)return r;return}(e);var n=t[e];return n===Pe?void 0:n}function Ge(e,t){let n=$e();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){Ne(e)}))}):(n[e]=void 0===t?Pe:t,function(){Ne(e)})}function Ne(e){let t=$e();delete t[e],0==Object.keys(t).length&&delete Me()[De]}function xe(e){let t=$e();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(je,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",Be),e("__GetDependency__",Be),e("__Rewire__",Ge),e("__set__",Ge),e("__reset__",Ne),e("__ResetDependency__",Ne),e("__with__",xe)}();function Ue(e,t){Object.defineProperty(Le,e,{value:t,enumerable:!1,configurable:!0})}function Fe(){const e="até ",t={FIXED:"fixed",PERCENTAGE:"percentage"},n="action",r="vip",o=e=>{if(!e)return!1;if(!e.hasOwnProperty("value"))return!1;if(!e.hasOwnProperty("type"))return!1;const n=e.type===t.FIXED,r=e.type===t.PERCENTAGE;return n||r},i=e=>null==e?void 0:e.isUpTo,a=e=>e.value,s=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(e).replace(/\s/g,""),c=e=>new Intl.NumberFormat("pt-BR",{style:"percent",maximumFractionDigits:2}).format(e),u=(e,n)=>{if(isNaN(e))return"0";return n===t.FIXED?s(e):c(e)},l=e=>{if(!e||0==Object.keys(e).length)return!1;const t=e.hasOwnProperty("originalCashback");if(!t)return!1;const n=e.originalCashback.hasOwnProperty("value"),r=e.originalCashback.hasOwnProperty("type");return t&&n&&r},_=e=>!(null==e||!e.isBoosted);return{formatCashback:t=>{if(!o(t))return"0";const n=t.type,r=a(t);if(0===r)return"Cashback Indisponível";const s=u(r,n),c=i(t);return 0===r?r:(c?e:"")+s},formatOriginalCashback:e=>{if(!l(e))return"";const t=e.originalCashback.type;return t?"fixed"===t?`(era ${s(e.originalCashback.value)})`:"percentage"===t?`(era ${c(e.originalCashback.value)})`:void 0:""},formatPrimeCashback:t=>{if(!o(t.cashbackWithoutPrime))return"";const n=t.cashbackWithoutPrime.type,r=a(t.cashbackWithoutPrime),s=u(r,n);return(i(t)?e:"")+s+" sem Cuponomia Prime"},getCashbackBadge:e=>!!_(e)&&(e.boostType===n?{type:"superCashback",color:"#8459b4",text:"Super cashback"}:e.boostType===r&&{type:"userVip",color:"#E59B1F",text:"Cashback VIP"}),storeHasValidCashback:e=>{if(!!!e)return!1;if(!e.hasOwnProperty("cashback"))return!1;return o(e.cashback)},hasValidOriginalCashback:l,CheckShouldDisplayUpToMessage:i,formatFixedCashback:s,formatPercentageCashback:c,getCashbackSegmentationByType:(e,t)=>{if(!e||null==e||!e.cashback||!t)return[];const n=(e.cashback.segmentations??[]).find((e=>e.type===t));return(null==n?void 0:n.items)??[]},hasCashbackBadge:_,CASHBACK_TYPES:t,isPrime:e=>!(null==e||!e.isPrime),isSuperCashbackAndLastDay:e=>{if(!_(e))return!1;e.boostType;const t=new Date,n=new Date(e.boostEndDate);return Qe("isSameDate")(t,n)},hasSegments:e=>{var t;return(null==e||null===(t=e.segmentations)||void 0===t?void 0:t.length)>0},hasUnavailableCashback:e=>0===a(e),isSuperCashback:e=>!!_(e)&&e.boostType===n}}function We(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}Object.isExtensible(Le)&&(Ue("__get__",Be),Ue("__GetDependency__",Be),Ue("__Rewire__",Ge),Ue("__set__",Ge),Ue("__reset__",Ne),Ue("__ResetDependency__",Ne),Ue("__with__",xe),Ue("__RewireAPI__",je));var He=null;function Ve(){if(null===He){let e=We();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),He=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return He}function Ye(){let e=We();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function qe(){let e=Ve(),t=Ye(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=We();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Xe="__INTENTIONAL_UNDEFINED__";let ze={};function Qe(e){let t=qe();if(void 0===t[e])return function(e){if("isSameDate"===e)return G;return}(e);var n=t[e];return n===Xe?void 0:n}function Ke(e,t){let n=qe();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){Je(e)}))}):(n[e]=void 0===t?Xe:t,function(){Je(e)})}function Je(e){let t=qe();delete t[e],0==Object.keys(t).length&&delete Ye()[Ve]}function Ze(e){let t=qe();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(ze,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",Qe),e("__GetDependency__",Qe),e("__Rewire__",Ke),e("__set__",Ke),e("__reset__",Je),e("__ResetDependency__",Je),e("__with__",Ze)}();const et=async e=>{var t;return(null===(t=(await _t("AmazonClient").getJSON("features"))[e])||void 0===t?void 0:t.enabled)??!1},tt=async(e,t)=>{var n,r,o;const i=await _t("AmazonClient").getJSON("features");if(!!(null===(n=i[e])||void 0===n||!n.enabled))return!1;return null===(r=i[e])||void 0===r||null===(o=r.enabledStores)||void 0===o?void 0:o.includes(t)},nt=async(e,t)=>{var n,r,o;const i=await _t("AmazonClient").getJSON("features");if(!!(null===(n=i[e])||void 0===n||!n.enabled))return!0;return null===(r=i[e])||void 0===r||null===(o=r.disabledStores)||void 0===o?void 0:o.includes(t)},rt=async e=>{const t=await _t("AmazonClient").getJSON("features");return e in t?t[e]:null};function ot(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var it=null;function at(){if(null===it){let e=ot();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),it=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return it}function st(){let e=ot();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function ct(){let e=at(),t=st(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=ot();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var ut="__INTENTIONAL_UNDEFINED__";let lt={};function _t(e){let t=ct();if(void 0===t[e])return function(e){switch(e){case"AmazonClient":return J;case"isFeatureDisabledInStore":return nt;case"isFeatureEnabledInStore":return tt;case"getFeatureConfig":return rt}return}(e);var n=t[e];return n===ut?void 0:n}function dt(e,t){let n=ct();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){ft(e)}))}):(n[e]=void 0===t?ut:t,function(){ft(e)})}function ft(e){let t=ct();delete t[e],0==Object.keys(t).length&&delete st()[at]}function ht(e){let t=ct();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(lt,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",_t),e("__GetDependency__",_t),e("__Rewire__",dt),e("__set__",dt),e("__reset__",ft),e("__ResetDependency__",ft),e("__with__",ht)}();function pt(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function gt(e,t){return e.get(mt(e,t))}function mt(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var bt=new WeakMap;class vt{constructor(e){var t,n,r;pt(this,bt,void 0),n=this,r=e,(t=bt).set(mt(t,n),r)}async getTestGroup(){const e=await gt(bt,this).getSetting("test_group");if(e)return e;const t=(await gt(bt,this).get("config")).data.config.value.ABPercentage??.5,n=Math.random()<t?"A":"B";return gt(bt,this).setSetting({key:"test_group",value:n}),n}async getTestGroupByName(e){let{name:t}=e;const n=await gt(bt,this).getSetting(`test_group_${t}`);if(n)return n;const r=(await gt(bt,this).get("config")).data.config.value[t]??.5,o=Math.random()<r?"A":"B";return gt(bt,this).setSetting({key:`test_group_${t}`,value:o}),o}async getTestGroupBySlugInABList(e){let{slug:t,name:n}=e;if(!t||!n)return null;const r=await It("db").getAsync("testAbList");if(!r)return null;return(r[t]||{})[n]||null}async addTestInABlistBySlug(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{slug:null,name:null};if(!e||null==e||!e.name||null==e||!e.slug)return;const{name:t,slug:n}=e,r=await It("getFeatureConfig")("test-ab-redirecttonewtab"),o=(null==r?void 0:r.enabled)||!1,i=((null==r?void 0:r.blacklist)||[]).includes(n);if(!o||i)return;let a=await It("db").getAsync("testAbList");if(!a){const e={};It("db").add("testAbList",e,(()=>{})),a=await It("db").getAsync("testAbList")}const s=a[n]||{};if(s[t])return;const c=(null==r?void 0:r.ABPercentage)||.5,u=Math.random()<c?"A":"B";a[n]={...s,[t]:u};try{const e={...a};It("db").add("testAbList",e,(()=>{}))}catch(e){console.error("Error saving test group:",e)}return null}}function Et(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var yt=null;function wt(){if(null===yt){let e=Et();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),yt=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return yt}function Rt(){let e=Et();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Tt(){let e=wt(),t=Rt(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=Et();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Ot="__INTENTIONAL_UNDEFINED__";let Ct={};function It(e){let t=Tt();if(void 0===t[e])return function(e){switch(e){case"db":return b;case"getFeatureConfig":return rt}return}(e);var n=t[e];return n===Ot?void 0:n}function Lt(e,t){let n=Tt();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){St(e)}))}):(n[e]=void 0===t?Ot:t,function(){St(e)})}function St(e){let t=Tt();delete t[e],0==Object.keys(t).length&&delete Rt()[wt]}function At(e){let t=Tt();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(Ct,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",It),e("__GetDependency__",It),e("__Rewire__",Lt),e("__set__",Lt),e("__reset__",St),e("__ResetDependency__",St),e("__with__",At)}();function kt(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var Dt=null;function Mt(){if(null===Dt){let e=kt();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),Dt=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return Dt}function $t(){let e=kt();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Pt(){let e=Mt(),t=$t(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=kt();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var jt="__INTENTIONAL_UNDEFINED__";let Bt={};function Gt(e){let t=Pt();if(void 0===t[e])return function(e){switch(e){case"getFeatureConfig":return rt;case"isFeatureDisabledInStore":return nt}return}(e);var n=t[e];return n===jt?void 0:n}function Nt(e,t){let n=Pt();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){xt(e)}))}):(n[e]=void 0===t?jt:t,function(){xt(e)})}function xt(e){let t=Pt();delete t[e],0==Object.keys(t).length&&delete $t()[Mt]}function Ut(e){let t=Pt();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(Bt,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",Gt),e("__GetDependency__",Gt),e("__Rewire__",Nt),e("__set__",Nt),e("__reset__",xt),e("__ResetDependency__",xt),e("__with__",Ut)}();var Ft=n(86636),Wt=n.n(Ft);const Ht=()=>Zt("bowser").getParser(window.navigator.userAgent),Vt=()=>Zt("getBrowserInfo")().getBrowser().name;function Yt(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var qt=null;function Xt(){if(null===qt){let e=Yt();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),qt=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return qt}function zt(){let e=Yt();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Qt(){let e=Xt(),t=zt(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=Yt();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Kt="__INTENTIONAL_UNDEFINED__";let Jt={};function Zt(e){let t=Qt();if(void 0===t[e])return function(e){switch(e){case"bowser":return Wt();case"getBrowserName":return Vt;case"getBrowserInfo":return Ht}return}(e);var n=t[e];return n===Kt?void 0:n}function en(e,t){let n=Qt();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){tn(e)}))}):(n[e]=void 0===t?Kt:t,function(){tn(e)})}function tn(e){let t=Qt();delete t[e],0==Object.keys(t).length&&delete zt()[Xt]}function nn(e){let t=Qt();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(Jt,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",Zt),e("__GetDependency__",Zt),e("__Rewire__",en),e("__set__",en),e("__reset__",tn),e("__ResetDependency__",tn),e("__with__",nn)}();let rn={getMastersessionID:async function(){const e="emsid";let t=await fn("db").getCache(e);const n=await fn("generalHelper").getCache("extension-mastersession-id");return t&&"string"==typeof t&&""!==t.trim()||(t=fn("generalHelper").idGenerator()),fn("db").addCache(e,t,n),t}};const on=rn;function an(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var sn=null;function cn(){if(null===sn){let e=an();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),sn=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return sn}function un(){let e=an();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function ln(){let e=cn(),t=un(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=an();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var _n="__INTENTIONAL_UNDEFINED__";let dn={};function fn(e){let t=ln();if(void 0===t[e])return function(e){switch(e){case"db":return b;case"generalHelper":return po}return}(e);var n=t[e];return n===_n?void 0:n}function hn(e,t){let n=ln();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){pn(e)}))}):(n[e]=void 0===t?_n:t,function(){pn(e)})}function pn(e){let t=ln();delete t[e],0==Object.keys(t).length&&delete un()[cn]}function gn(e){let t=ln();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(dn,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",fn),e("__GetDependency__",fn),e("__Rewire__",hn),e("__set__",hn),e("__reset__",pn),e("__ResetDependency__",pn),e("__with__",gn)}();function mn(e,t){Object.defineProperty(rn,e,{value:t,enumerable:!1,configurable:!0})}Object.isExtensible(rn)&&(mn("__get__",fn),mn("__GetDependency__",fn),mn("__Rewire__",hn),mn("__set__",hn),mn("__reset__",pn),mn("__ResetDependency__",pn),mn("__with__",gn),mn("__RewireAPI__",dn));const bn=async e=>{let{store:t,feature_click:n,userLoggedIn:r=!1,redirect:o={status:!1}}=e;const i=await Cn("eventHelper").getMastersessionID();let a=`https://www.cuponomia.com.br/ext/stores/${t.id}/clickout?feature_click=${n}&emsid=${i}`;return o.status&&(a+=`&redirect=${o.link}`),r||(a=a.replace("#cadastro-pedagio","")+"#cadastro-pedagio"),a};function vn(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var En=null;function yn(){if(null===En){let e=vn();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),En=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return En}function wn(){let e=vn();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Rn(){let e=yn(),t=wn(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=vn();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Tn="__INTENTIONAL_UNDEFINED__";let On={};function Cn(e){let t=Rn();if(void 0===t[e])return function(e){switch(e){case"eventHelper":return on;case"generateTollURL":return bn}return}(e);var n=t[e];return n===Tn?void 0:n}function In(e,t){let n=Rn();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){Ln(e)}))}):(n[e]=void 0===t?Tn:t,function(){Ln(e)})}function Ln(e){let t=Rn();delete t[e],0==Object.keys(t).length&&delete wn()[yn]}function Sn(e){let t=Rn();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(On,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",Cn),e("__GetDependency__",Cn),e("__Rewire__",In),e("__set__",In),e("__reset__",Ln),e("__ResetDependency__",Ln),e("__with__",Sn)}();class An{async add(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{key:"",value:null};if(!e||null==e||!e.key)return;const{key:t,value:n}=e;return new Promise((e=>{chrome.runtime.sendMessage({action:"dbAdd",data:{key:t,value:n}},(t=>e(t)))}))}async remove(e){if(e)return new Promise((t=>{chrome.runtime.sendMessage({action:"dbRemove",data:{key:e}},(e=>{t(e)}))}))}async get(e){if(e)return new Promise((t=>{chrome.runtime.sendMessage({action:"dbGet",data:{key:e}},(e=>{t(e)}))}))}async addToSettings(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{key:"",value:null};if(!e||null==e||!e.key)return;const{key:t,value:n}=e;return new Promise((e=>{chrome.runtime.sendMessage({action:"setSetting",data:{key:t,value:n}},(t=>{e(t)}))}))}async getFromSettings(e){if(e)return new Promise((t=>{chrome.runtime.sendMessage({action:"getSetting",data:{key:e}},(e=>{t(e)}))}))}}function kn(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var Dn=null;function Mn(){if(null===Dn){let e=kn();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),Dn=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return Dn}function $n(){let e=kn();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Pn(){let e=Mn(),t=$n(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=kn();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var jn="__INTENTIONAL_UNDEFINED__";let Bn={};function Gn(e){let t=Pn();if(void 0===t[e])return function(e){if("LocalStorage"===e)return An;return}(e);var n=t[e];return n===jn?void 0:n}function Nn(e,t){let n=Pn();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){xn(e)}))}):(n[e]=void 0===t?jn:t,function(){xn(e)})}function xn(e){let t=Pn();delete t[e],0==Object.keys(t).length&&delete $n()[Mn]}function Un(e){let t=Pn();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(Bn,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",Gn),e("__GetDependency__",Gn),e("__Rewire__",Nn),e("__set__",Nn),e("__reset__",xn),e("__ResetDependency__",xn),e("__with__",Un)}();const Fn=()=>{const e=new(Qn("LocalStorage")),t={get:e.get,getSetting:e.getFromSettings,setSetting:e.addToSettings,add:e.add};return new(Qn("ABTest"))(t)};function Wn(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var Hn=null;function Vn(){if(null===Hn){let e=Wn();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),Hn=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return Hn}function Yn(){let e=Wn();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function qn(){let e=Vn(),t=Yn(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=Wn();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Xn="__INTENTIONAL_UNDEFINED__";let zn={};function Qn(e){let t=qn();if(void 0===t[e])return function(e){switch(e){case"LocalStorage":return An;case"ABTest":return vt}return}(e);var n=t[e];return n===Xn?void 0:n}function Kn(e,t){let n=qn();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){Jn(e)}))}):(n[e]=void 0===t?Xn:t,function(){Jn(e)})}function Jn(e){let t=qn();delete t[e],0==Object.keys(t).length&&delete Yn()[Vn]}function Zn(e){let t=qn();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(zn,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",Qn),e("__GetDependency__",Qn),e("__Rewire__",Kn),e("__set__",Kn),e("__reset__",Jn),e("__ResetDependency__",Jn),e("__with__",Zn)}();const{storeHasValidCashback:er}=_r("useCashback")();class tr{constructor(e){this.baseUrl=e}async getStatement(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=await _r("db").getCache("user_statement");if((null===(t=r)||void 0===t?void 0:t.user)===e&&r[n])return{cashbacks:r[n],totalPages:r.totalPages};let o=await fetch(`https://www.cuponomia.com.br/ext/account/statement?page=${n}`,{method:"get",headers:{"api-version":3}}).then((e=>e.json()));return Object.keys(o).length?(r&&r.user===e||(r={user:e,totalPages:o.totalPages}),r[n]=o.cashbacks,_r("db").addCache("user_statement",r,await _r("generalHelper").getCache("user-statement")),o):null}async getDataStore(e,t){if(!e)return{store:{bestCoupons:[]},slug:e};const n=await _r("generalHelper").getCache("store-data"),r=`https://www.cuponomia.com.br/ext/stores/${e}`,o={"api-version":3};try{const t=await _r("db").getCacheEtag(`cache_${e}`,r,n,o);if(!Object.keys(t).length)return{store:{bestCoupons:[]},slug:e};if(t.extensionConfiguration&&!t.extensionConfiguration.redirectToNewTab&&_r("storeHasValidCashback")(t))try{const n=_r("getABTestInstance")();await n.addTestInABlistBySlug({slug:e,name:"store-redirect-testAB"});const r=await n.getTestGroupBySlugInABList({slug:e,name:"store-redirect-testAB"});"B"===r&&(t.extensionConfiguration.redirectToNewTab=!0)}catch(e){console.error("Error adding store to test group:",e)}return{store:{...t},slug:e}}catch{return{store:{bestCoupons:[]},slug:e}}}async getStoreFeed(e,t){if(!e)return{store:{bestCoupons:[]},slug:e};const n=await _r("generalHelper").getCache("store-data"),r=`https://www.cuponomia.com.br/ext/stores/${e}/feed`,o={"api-version":3};try{const t=await _r("db").getCacheEtag(`cache_${e}`,r,n,o);if(!Object.keys(t).length)return{store:{bestCoupons:[]},slug:e};if(!["bestCoupons","similarStores"].every((e=>null==t?void 0:t[e]))){var i;const t=`https://www.cuponomia.com.br/ext/stores/${e}/feed`,r=await _r("db").getCacheEtag(`cache_temp_${e}`,t,n,o);if(!Object.keys(r).length)return _r("db").remove(`cache_temp_${e}`),{store:{bestCoupons:[]},slug:e};const a=(new Date).getTime()+n,s={bestCoupons:(null==r?void 0:r.bestCoupons)||[],similarStores:(null==r?void 0:r.similarStores)||[]},c={...r,numberOfCoupons:null==r||null===(i=r.bestCoupons)||void 0===i?void 0:i.length,...s};return _r("db").set(`cache_${e}`,c,a),_r("db").remove(`cache_temp_${e}`),{store:{...c},slug:e}}return{store:{...t},slug:e}}catch{return{store:{bestCoupons:[]},slug:e}}}async getDataProductSimilar(e){const t=`https://6d3n67ye30.execute-api.sa-east-1.amazonaws.com/prod/hyperion?${e}`,n=await fetch(t,{method:"GET"});return n.data=await n.json(),n.data}async getDataAccount(){const e="user_data",t=await _r("db").getAsync(e);Object.keys((null==t?void 0:t.value)||{}).length>0||await _r("db").removeAsync(e);return await _r("db").getCacheEtag(e,""+(this.baseUrl+"ext/account/profile"),await _r("generalHelper").getCache("user-data"),{"Content-Type":"application/json","X-Content-Type-Options":"nosniff"})}async getDataCampaign(){return await _r("db").getCacheEtag("referral_campaign",""+(this.baseUrl+"ext/campaign/referral"),await _r("generalHelper").getCache("referral-campaign"))}async getAccountBalance(e){if(!e)return 0;const t=await _r("generalHelper").getCache("user-balance");return await _r("db").getCacheEtag("user_balance","https://www.cuponomia.com.br/ext/account/balance",t||_r("generalHelper").millisecondsPerMinutes(30))}async sendFeedbackProductSimilar(e){}async sendStoreTracker(e,t){const n=e.find((e=>"slug"===e.Key)),r=`https://www.cuponomia.com.br/ext/stores/${(null==n?void 0:n.Value)||""}/page-view?${t}`;return await fetch(r,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({Parameters:e})})}async getTopStores(){const e=await _r("db").getCacheEtag("top_stores",`${this.baseUrl}ext/featured/stores`,await _r("generalHelper").getCache("top-stores"),{"api-version":3}),t=null==e?void 0:e.filter((e=>_r("storeHasValidCashback")(e))).slice(0,3);return t}async sendGreenTransaction(e){if(!e.uuid)return;return fetch("https://www.cuponomia.com.br/ext/green-transaction",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({Slug:e.store.slug,UniversalId:e.uuid})}).then((e=>e.json()))}async getStoresBySearch(e){if(null==e||!e.searchTerm)return[];return await fetch(`https://www.cuponomia.com.br/ext/stores/search?query=${e.searchTerm}`,{method:"GET",headers:{"api-version":3}}).then((e=>e.json()))}async searchBestOffers(e){if(!e)return[];const t=await fetch(`https://www.cuponomia.com.br/ext/offers/search?query=${e}`,{method:"GET",headers:{"api-version":3}}).then((e=>e.json())),n=await _r("getFeatureConfig")("search-best-offers"),r=(null==n?void 0:n.blacklist)||[];return t.itens=t.itens.filter((e=>!r.includes(e.store.slug))),t}async getBestOffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=""!==t?`best_offers_${t}`:"best_offers";let r=await _r("db").getCache(n);if(r&&r[e])return{totalCount:r.totalCount,itens:r[e]};const o=""!==t?`https://www.cuponomia.com.br/ext/stores/${t}/offers?page=${e}`:`https://www.cuponomia.com.br/ext/offers?page=${e}`;let i=await fetch(o,{method:"get",headers:{"api-version":3}}).then((e=>e.json()));if(!Object.keys(null==i?void 0:i.itens).length)return null;r||(r={});const a=await _r("getFeatureConfig")("best-offers"),s=(null==a?void 0:a.blacklist)||[];return i.itens=i.itens.filter((e=>!s.includes(e.store.slug))),r[e]=i.itens,r.totalCount=i.totalCount,_r("db").addCache(n,r,await _r("generalHelper").getCache("best-offers")),{totalCount:i.totalCount,itens:i.itens}}async getData(e){let{url:t,cacheName:n,cacheTimeKey:r}=e;if(!t||!n||!r)return null;let o=null;try{const e=await _r("generalHelper").getCache(r);o=await _r("db").getCacheEtag(n,`${this.baseUrl+t}`,e||_r("generalHelper").millisecondsPerMinutes(360))}catch(e){console.error(`ERROR - GET DATA FROM: ${t}`)}return o}}let nr=new(_r("CuponomiaRestClient"))("https://www.cuponomia.com.br/");const rr=nr;function or(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var ir=null;function ar(){if(null===ir){let e=or();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),ir=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return ir}function sr(){let e=or();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function cr(){let e=ar(),t=sr(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=or();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var ur="__INTENTIONAL_UNDEFINED__";let lr={};function _r(e){let t=cr();if(void 0===t[e])return function(e){switch(e){case"useCashback":return Fe;case"db":return b;case"generalHelper":return po;case"storeHasValidCashback":return er;case"getABTestInstance":return Fn;case"getDateTime":return M;case"getFeatureConfig":return rt;case"CuponomiaRestClient":return tr}return}(e);var n=t[e];return n===ur?void 0:n}function dr(e,t){let n=cr();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){fr(e)}))}):(n[e]=void 0===t?ur:t,function(){fr(e)})}function fr(e){let t=cr();delete t[e],0==Object.keys(t).length&&delete sr()[ar]}function hr(e){let t=cr();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(lr,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",_r),e("__GetDependency__",_r),e("__Rewire__",dr),e("__set__",dr),e("__reset__",fr),e("__ResetDependency__",fr),e("__with__",hr)}();let pr=typeof nr;function gr(e,t){Object.defineProperty(nr,e,{value:t,enumerable:!1,configurable:!0})}"object"!==pr&&"function"!==pr||!Object.isExtensible(nr)||(gr("__get__",_r),gr("__GetDependency__",_r),gr("__Rewire__",dr),gr("__set__",dr),gr("__reset__",fr),gr("__ResetDependency__",fr),gr("__with__",hr),gr("__RewireAPI__",lr));let mr={getData:async function(){let e=await Cr("generalHelper").ensureUserCookies();return{email:await Cr("loginHelper").getUser(),...e}},getUserInfo:async function(){return await Cr("loginHelper").getUser()},getUserUniversalId:async function(){return await Cr("loginHelper").getUuid()},getBalance:async function(){let e=await this.getUserInfo();return e?await Cr("CuponomiaRestClient").getAccountBalance(e):null},userRedeem:async function(){const e=await fetch("https://www.cuponomia.com.br/rewards/redeem",{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest"}}),t=await e.json();return{status:e.status,body:t}},getUserData:async function(){if(!await this.getUserUniversalId())return null;return await new Promise((async(e,t)=>{try{return e(await Cr("CuponomiaRestClient").getData({url:"ext/session",cacheName:"user_session",cacheTimeKey:"user-session"}))}catch(e){0}return e(null)}))},clearUserData:function(){return["referral-campaign"].forEach((e=>Cr("db").removeSession(e))),["user_data","referral-campaign","user_balance","top_stores","user_session","user_statement"].forEach((e=>Cr("db").remove(e))),!0},hasUserVip:async function(){if(!await Cr("loginHelper").getUser())return Cr("db").remove("user-vip"),!1;const e=await this.getUserData();return(null==e?void 0:e.isVip)??!1},getUserPreferences:async function(){var e;const t=[{id:"similar-products",label:"Produtos similares com cashback",checked:!0,position:1},{id:"toast-cashback",label:"Lembrete de ativação de cashback dentro da loja",checked:!0,position:2},{id:"modal-remember",label:"Lembrete de ativação de cashback fora da loja",checked:!0,position:3},{id:"toast-relations",label:"Sites similares com cashback",checked:!0,position:4},{id:"cart-modal",label:"Cupons no carrinho de compras",checked:!0,position:5},{id:"notifications",label:"Notificações de mega cashback",checked:!0,position:6}];let n=await new Promise((e=>Cr("db").get("user_preferences",(t=>{var n;return e(null==t||null===(n=t.data)||void 0===n?void 0:n.user_preferences)}))));return(null===(e=n)||void 0===e?void 0:e.length)!==t.length&&(n=n?t.map((e=>{const t=n.find((t=>t.id===e.id));return t&&(e.checked=t.checked),e})):t,Cr("db").add("user_preferences",n)),Object.defineProperty(n,"hasPreference",{value:function(e){var t;return null===(t=this.find((t=>t.id===e)))||void 0===t?void 0:t.checked}}),n},logout(){chrome.tabs.create({url:"https://www.cuponomia.com.br/sair",active:!1,pinned:!0,index:0},(e=>{let t=(n,r)=>(n===e.id&&"complete"===r.status&&(this.clearUserData(),chrome.tabs.remove(n),chrome.tabs.onUpdated.removeListener(t)),!0);chrome.tabs.onUpdated.addListener(t)}))},getUserProfileData:async()=>Cr("CuponomiaRestClient").getDataAccount()};const br=mr;function vr(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var Er=null;function yr(){if(null===Er){let e=vr();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),Er=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return Er}function wr(){let e=vr();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Rr(){let e=yr(),t=wr(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=vr();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Tr="__INTENTIONAL_UNDEFINED__";let Or={};function Cr(e){let t=Rr();if(void 0===t[e])return function(e){switch(e){case"generalHelper":return po;case"loginHelper":return Se;case"CuponomiaRestClient":return rr;case"db":return b}return}(e);var n=t[e];return n===Tr?void 0:n}function Ir(e,t){let n=Rr();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){Lr(e)}))}):(n[e]=void 0===t?Tr:t,function(){Lr(e)})}function Lr(e){let t=Rr();delete t[e],0==Object.keys(t).length&&delete wr()[yr]}function Sr(e){let t=Rr();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(Or,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",Cr),e("__GetDependency__",Cr),e("__Rewire__",Ir),e("__set__",Ir),e("__reset__",Lr),e("__ResetDependency__",Lr),e("__with__",Sr)}();function Ar(e,t){Object.defineProperty(mr,e,{value:t,enumerable:!1,configurable:!0})}function kr(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.isExtensible(mr)&&(Ar("__get__",Cr),Ar("__GetDependency__",Cr),Ar("__Rewire__",Ir),Ar("__set__",Ir),Ar("__reset__",Lr),Ar("__ResetDependency__",Lr),Ar("__with__",Sr),Ar("__RewireAPI__",Or));const Dr=!1;class Mr{constructor(){if(kr(this,"_instance",null),kr(this,"readyTabIds",[]),kr(this,"resolveReadyPromise",null),Ur("ForegroundHelper")._instance)return Ur("ForegroundHelper")._instance;Ur("ForegroundHelper")._instance=this}setForegroundReady(e){let{tabId:t=null}=e;if(!t)return;this.readyTabIds.some((e=>e===t))?Ur("isDevelopmentMode")&&console.log("[FOREGROUND HELPER] - ESTA TAB JA ESTA CARREGADA -",t):(this.readyTabIds.push(t),Ur("isDevelopmentMode")&&(console.log("[FOREGROUND HELPER] - ADICIONANDO TABID -",t),console.log("[FOREGROUND HELPER] - TAB IDS REGISTRADOS -",this.readyTabIds)),this.resolveReadyPromise&&(this.resolveReadyPromise({tabId:t}),Ur("isDevelopmentMode")&&console.log("[FOREGROUND HELPER] - CARREGAMENTO COMPLETO - RESOLVE -",t)))}waitForReady(e){let{tabId:t=null}=e;if(!t)return;if(!this.readyTabIds.some((e=>e===t)))return new Promise((e=>{this.resolveReadyPromise=e,Ur("isDevelopmentMode")&&console.log("[FOREGROUND HELPER] - ESPERANDO TAB COMPLETAR CARREGAMENTO -",t)}));Ur("isDevelopmentMode")&&console.log("[FOREGROUND HELPER] - ESTA TAB JA ESTA CARREGADA -",t)}removeTabIdFromReadyList(e){let{tabId:t=null}=e;if(!t)return;const n=this.readyTabIds.findIndex((e=>e===t));-1!==n&&(this.readyTabIds.splice(n,1),Ur("isDevelopmentMode")&&(console.log("[FOREGROUND HELPER] - REMOVENDO TABID -",t),console.log("[FOREGROUND HELPER] - TAB IDS REGISTRADOS -",this.readyTabIds)))}}function $r(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var Pr=null;function jr(){if(null===Pr){let e=$r();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),Pr=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return Pr}function Br(){let e=$r();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Gr(){let e=jr(),t=Br(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=$r();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Nr="__INTENTIONAL_UNDEFINED__";let xr={};function Ur(e){let t=Gr();if(void 0===t[e])return function(e){switch(e){case"ForegroundHelper":return Mr;case"isDevelopmentMode":return Dr}return}(e);var n=t[e];return n===Nr?void 0:n}function Fr(e,t){let n=Gr();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){Wr(e)}))}):(n[e]=void 0===t?Nr:t,function(){Wr(e)})}function Wr(e){let t=Gr();delete t[e],0==Object.keys(t).length&&delete Br()[jr]}function Hr(e){let t=Gr();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(xr,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",Ur),e("__GetDependency__",Ur),e("__Rewire__",Fr),e("__set__",Fr),e("__reset__",Wr),e("__ResetDependency__",Wr),e("__with__",Hr)}();function Vr(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function Yr(e,t){return e.get(Xr(e,t))}function qr(e,t,n){return e.set(Xr(e,t),n),n}function Xr(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var zr=new WeakMap,Qr=new WeakMap;class Kr{constructor(e,t){Vr(this,zr,null),Vr(this,Qr,null),qr(zr,this,e),qr(Qr,this,t)}async getHostsBySlug(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{slug:""};if(!e||null==e||!e.slug)return null;const{slug:t}=e,n=await Yr(Qr,this).getHosts(),r=Object.entries(n).filter((e=>{let[n,r]=e;return r===t})).map((e=>{let[t]=e;return t}))??[];return r||null}async getStoreByUrl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{currentUrl:"",dataType:"main"};if(!e||null==e||!e.currentUrl)return null;const{currentUrl:t}=e;let n="";try{n=new URL(t).hostname+new URL(t).pathname}catch{n=t}const r=n.replace(/^(?:https?:\/\/)?(?:www\.)?/i,""),o=await Yr(Qr,this).getHosts(),[,i]=Object.entries(o).find((e=>{let[t]=e;return new RegExp(`^([a-zA-Z0-9-]+\\.)*${t.replace(/\./g,"\\.")}`).test(r)}))??[];if(!i)return null;const a="feed"===e.dataType?Yr(zr,this).getStoreFeed:Yr(zr,this).getDataStore;return(await a.call(Yr(zr,this),i)).store}async getStoreByName(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:""};if(!e||null==e||!e.name)return null;const{name:t}=e,n=await Yr(Qr,this).getHosts(),r=Object.values(n).find((e=>e.toLowerCase().replace(/[^a-zA-Z0-9+]/g,"")===t.toLowerCase().replace(/[^a-zA-Z0-9+]/g,"")));if(!r)return null;return(await Yr(zr,this).getDataStore(r)).store}async getStoreBySlug(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{slug:"",senderUrl:""};if(!e||null==e||!e.slug)return null;const{slug:t,senderUrl:n}=e;return(await Yr(zr,this).getDataStore(t,n)).store}async getAllSlugs(){const e=await Yr(Qr,this).getHosts();return Object.values(e)}escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}const Jr=()=>new(ao("StoreHandler"))(ao("CuponomiaRestClient"),ao("AmazonRestClient"));function Zr(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var eo=null;function to(){if(null===eo){let e=Zr();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),eo=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return eo}function no(){let e=Zr();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function ro(){let e=to(),t=no(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=Zr();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var oo="__INTENTIONAL_UNDEFINED__";let io={};function ao(e){let t=ro();if(void 0===t[e])return function(e){switch(e){case"StoreHandler":return Kr;case"CuponomiaRestClient":return rr;case"AmazonRestClient":return J}return}(e);var n=t[e];return n===oo?void 0:n}function so(e,t){let n=ro();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){co(e)}))}):(n[e]=void 0===t?oo:t,function(){co(e)})}function co(e){let t=ro();delete t[e],0==Object.keys(t).length&&delete no()[to]}function uo(e){let t=ro();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(io,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",ao),e("__GetDependency__",ao),e("__Rewire__",so),e("__set__",so),e("__reset__",co),e("__ResetDependency__",co),e("__with__",uo)}();const{formatCashback:lo,storeHasValidCashback:_o}=Ro("useCashback")(),fo=!1;let ho={async isFeatureDisabled(e){var t,n;return(null===(t=(await Ro("amazonClient").getExtensionConfig()).features)||void 0===t||null===(n=t[e])||void 0===n?void 0:n.disabled)??!1},checkBlacklist:async function(e){let t=await Ro("amazonClient").getCompetitors();Array.isArray(t)||(t=[]);const n=t.find((t=>{if(!(!!e.url||!!e.pendingUrl))return;const n=new URL(t.url),r=new URL(e.url||e.pendingUrl),o=n.hostname===r.hostname,i="/"===n.pathname||n.pathname===r.pathname,a=!!n.search,s=n.search===r.search;return o&&i&&(!a||a&&s)}))||{};return{...n,isBlacklist:!!Object.keys(n).length}},async checkInstalledExtensions(){if(await this.isFeatureDisabled("extension-checker"))return[];let e=await Ro("db").getCache("installed_extensions");if(!e){const t=await Ro("amazonClient").getExtensions();let n=[];console.groupCollapsed("Checking Extensions");for(let e of t)n.push(fetch(`chrome-extension://${e.id}`).then((()=>e.name)).catch((()=>null)));e=await Promise.allSettled(n).then((e=>e.map((e=>"fulfilled"===e.status&&e.value)).filter(Boolean))),console.groupEnd();const r=await this.getCache("installed-extensions");Ro("db").addCache("installed_extensions",e,r),chrome.alarms.create("installed_extensions",{delayInMinutes:this.minutesPerMilliseconds(r)})}return e},getGenericCoupons:async function(){return await Ro("amazonClient").getGenericCoupons()},getAllCookies:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=await this.getAllCuponomiaCookies(),n={...await this.ensureUserCookies(),...t};if(e){const t=/(&#|%26%23)(.*)/;e=e.replace(t,""),n.dvurl=e}return n},getTrackingData:async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const r=await this.getAllCookies(e),o=await this.checkInstalledExtensions(),i={...r,v:chrome.runtime.getManifest().version,market:"chrome-webstore",isPinned:await this.checkIsPinned()};if(!("newTab"===e)){const t=Ro("getStoreHandlerInstance")(),r=n??await t.getStoreByUrl({currentUrl:e}),o=(null==r?void 0:r.slug)??n;o&&(i.slug=o)}return o.length&&(i.installedExtensions=o),t?this.objectToQueryString(i):i},sanitizeData:function(e,t){for(const n of Object.keys(e))null!=e[n]?t&&!t.includes(n)&&"string"==typeof e[n]&&(e[n]=e[n].replace(/[^A-zÀ-ú0-9 ]/g,""),e[n]=e[n].replace(/\s\s+/g," ")):delete e[n];return e},trackPageView:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"direct",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;let o=!!(await Ro("userHelper").getUserPreferences()).hasPreference("notifications"),i=await this.getTrackingData(t);const a=await Ro("eventHelper").getMastersessionID();let s=this.objectToQueryString({...i,referrer:n,notification_opt_in:o,emsid:a,type:r});Ro("eventsClient").saveEventWith(s)},trackEvent:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=await this.getTrackingData(t);o[n]=r;const i=await Ro("eventHelper").getMastersessionID();let a=this.objectToQueryString({...o,emsid:i});Ro("eventsClient").saveEventWith(a)},trackNotification:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e=this.sanitizeData(e,["event_time_date","notification_landing_url"]);let n=await this.getTrackingData(t);const r=await Ro("eventHelper").getMastersessionID();let o=this.objectToQueryString({...n,...e,emsid:r});Ro("eventsClient").saveEventWith(o)},trackTutorial:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e=this.sanitizeData(e,["event_time_date","step","msid","uuid","sid"]);let n=await this.getTrackingData(t);const r=await Ro("eventHelper").getMastersessionID();let o=this.objectToQueryString({...n,...e,emsid:r});Ro("eventsClient").saveEventWith(o)},trackLookerEvent:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!Ro("development")||e&&e.evt&&""!==e.evt||console.error('You need to provide the name of the event in the "evt" key');const n={domain:new URL("https://www.cuponomia.com.br/").host},r=await this.getCookies(["msid","sid","uuid"],n),o={...e,msid:(null==r?void 0:r.msid)||null,uuid:(null==r?void 0:r.uuid)||null,sid:(null==r?void 0:r.sid)||null};null!=o&&o.event_time_date||(o.event_time_date=this.createFormattedDate());const i=this.sanitizeData(o,["event_time_date","msid","uuid","sid","position","slug","local","URL_product","URL_image","product_value","variation"]),a=await this.getTrackingData(t),s=await Ro("eventHelper").getMastersessionID(),c=this.objectToQueryString({...a,...i,emsid:s});Ro("development")&&(console.groupCollapsed(`Looker Send Event: ${e.evt} ${(null==o?void 0:o.action)||""}`),console.log(JSON.stringify(o)),console.groupEnd()),Ro("eventsClient").saveEventWith(c)},async trackingPageView(e){if(await Ro("isFeatureDisabledInStore")("store-tracker",e.slug))return;if(await Ro("db").getSession("store_page-view-ri"))return;const t=await this.getCache("pageview-checker");chrome.alarms.create(`store_page-view-ri_${e.slug}`,{delayInMinutes:this.minutesPerMilliseconds(t)})},async trackStore(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=Ro("getStoreHandlerInstance")(),r=await Ro("db").getCache(`cashback_activated_${e}`).then((e=>!!e));if(r)return;if(await Ro("db").getSession("store_page-view-ri"))return;const o=await n.getStoreBySlug({slug:e}),i=await this.getCache("store-tracker");Ro("db").addSession("store_page-view-ri",o.slug,i),chrome.alarms.create(`store_tracker_${e}`,{delayInMinutes:this.minutesPerMilliseconds(i)});const a={domain:new URL("https://www.cuponomia.com.br/").host},s=await this.getCookies(["msid","sid","uuid"],a),c={msid:(null==s?void 0:s.msid)||null,uuid:(null==s?void 0:s.uuid)||null,sid:(null==s?void 0:s.sid)||null},u=await this.getTrackingData(t),l=await this.checkIsPinned(),_=this.objectToQueryString({...c,...u}),d=[{Key:"slug",Value:o.slug},{Key:"storename",Value:o.name},{Key:"UID",Value:null==s?void 0:s.uuid},{Key:"cashback_at_moment",Value:Ro("formatCashback")(o.cashback)},{Key:"ispinned",Value:l}];Ro("CuponomiaRestClient").sendStoreTracker(d,_)},createFormattedDate(){let e=new Date;const t=e=>`0${e}`.slice(-2);return`${e.getFullYear()}-${t(e.getMonth()+1)}-${t(e.getDate())} ${t(e.getHours())}:${t(e.getMinutes())}:${t(e.getSeconds())}`},getPercent:function(e){return`${Number(Math.round(100*e+"e+2")+"e-2").toString().replace(".",",")}%`},getTackedUrlForProduct:function(e,t,n){return`${e}${t=t.substring(1)}?redirect=${n}#cadastro-pedagio`},createTollPageLink:async function(e){const t=new URL("https://www.cuponomia.com.br/");return await Ro("userHelper").getUserInfo()||(t.hash="cadastro-pedagio"),t.pathname=e,t.href},handleCuponomiaUrl:async function(e){const t=/cuponomia\.com\.br(\/out\/|\/e\/out\/|\/ext\/out\/|\/ext\/stores\/|\/ext\/coupons\/|\/coupon\/show\/)([0-9]*)/i.test(e);return t&&await this.setCashbackInTollPage(),t},setCashbackInTollPage:async function(){if("undefined"==typeof document)return;!!(e=>{var t;const n=`; ${null===(t=document)||void 0===t?void 0:t.cookie}`;if(!n)return!1;const r=n.split(`; ${e}=`);return 2===r.length&&r.pop().split(";").shift()})("uuid")&&window&&(window.onload=async()=>{var e;const t=null===(e=document.querySelector("[data-store-slug]"))||void 0===e?void 0:e.dataset.storeSlug;t&&await Ro("db").addCache(`cashback_activated_toll_${t}`,{location},this.millisecondsPerHours(1))})},hasCashbackSetTollPage:async function(e){return!!await Ro("db").getCache(`cashback_activated_toll_${e}`)},setCashbackInCashbackPage:async function(e){await Ro("db").addCache(`cashback_activated_cashback_page_${e}`,{location},6e4)},hasCashbackSetCashbackPage:async function(e){return!!await Ro("db").getCache(`cashback_activated_cashback_page_${e}`)},isCuponomiaPage:function(e){return new URL(e).host.includes("cuponomia.com.br")},isCuponomiaToll:function(e){if(!e)return!1;const t=["/coupon/show/","/out/","/extensao/instalar","/clickout"].some((t=>e.includes(t)));return this.isCuponomiaPage(e)&&t},isGoogleSearchPage:function(e){return/google\.[\w|.]{2,}\/search/.test(e)},isBingSearchPage:function(e){return/bing\.[\w|.]{2,}\/search/.test(e)},isExtensionPages:function(e){return!!e&&-1!==e.indexOf("chrome://")},isOnCartPage:function(e,t){if(null==e||!e.extensionConfiguration)return!1;let n=e=>e.replace(/^(?:https?:\/\/)?(?:www\.)?/i,"");const r=n(t).split("?")[0],{carts:o=[]}=null==e?void 0:e.extensionConfiguration,i={keywords:new RegExp("carrinho.|sacola.|basket.|cart.|checkout.|buy.|/carrinho|/sacola|/basket|/cart|/buy|/webapp/wcs/stores|/a#cesta|/cart-show|/checkout|vendadpsp","i"),declaredPage(e){const t=n(e);return new RegExp(t,"i")}};return o.length?0!==o.filter((e=>i.declaredPage(e).test(n(r)))).length:i.keywords.test(t)},isOnPaymentPage:function(e,t){let n=e=>e.replace(/^(?:https?:\/\/)?(?:www\.)?/i,"");const r=n(t).split("?")[0],{payments:o=[]}=(null==e?void 0:e.extensionConfiguration)??{};if(null==o||!o.length)return!1;return 0!==o.filter((e=>(e=>{const t=n(e);return new RegExp(t,"i")})(e).test(n(r)))).length},isOnHomePage:function(e,t){if(null==e||!e.length)return!1;let n=new URL(t),r=`${(e=>e.replace(/^(?:www\.)?/i,""))(n.host)}${n.pathname.length>1?n.pathname:""}`;return e.includes(r)},isOnThankYouPage:async function(e,t){var n,r;if(!t||!e)return!1;const o=Ro("getStoreHandlerInstance")(),i=await this.getThankYouStore({slug:e});if(!i)return!1;const a=i.paths.some((e=>t.includes(e))),s=await o.getStoreBySlug({slug:i.slug});if(!(null==s||null===(n=s.extensionConfiguration)||void 0===n||null===(r=n.cashbackPage)||void 0===r?void 0:r.cookieToVerify))return a;const c=await this.verifyThankYouPageInCashbackPage({store:s,currentHost:t});return a&&c},verifyThankYouPageInCashbackPage:async function(e){var t;let{store:n,currentHost:r}=e;if(null==n||!n.cashbackPage)return!1;const{cookieToVerify:o}=null===(t=n.extensionConfiguration)||void 0===t?void 0:t.cashbackPage,i=await this.handleGetCookie({url:r,name:null==o?void 0:o.name});if(!i)return!1;return await this.hasValidCashbackPageCookie({cashbackPage:n.extensionConfiguration.cashbackPage,cookies:[i],currentHost:r})},isOnBlacklistPage:function(e,t){if(null==e||!e.length)return!1;for(let n of e)if(t.includes(n))return!0;return!1},isOnCouponPage:async function(e,t){let n=(await Ro("amazonClient").getCouponTester()).find((t=>t.slug===e));return!(!n||n.disabled)&&(null==n?void 0:n.paths.some((e=>t.includes(e))))},isOnCashbackPage:async function(e,t){var n,r;if(!e||!e.hosts&&!e.unreferencedRoutes)return!1;let o=!1;if(null!==(n=e.cookieToVerify)&&void 0!==n&&n.name&&null!==(r=e.cookieToVerify)&&void 0!==r&&r.value){var i,a;const n=e.cookieToVerify&&(null===(i=e.unreferencedRoutes)||void 0===i?void 0:i.map((t=>{var n;return this.handleGetCookie({url:t,name:null===(n=e.cookieToVerify)||void 0===n?void 0:n.name})})))||[],r=(await Promise.all(n)).some((t=>{var n;return(null==t?void 0:t.value)===(null===(n=e.cookieToVerify)||void 0===n?void 0:n.value)})),s=null===(a=e.unreferencedRoutes)||void 0===a?void 0:a.some((e=>{const n=this.removeProtocolsFromUrl(t),r=this.removeProtocolsFromUrl(e);return n.includes(r)}));o=r&&s}return e.hosts.some((e=>new RegExp(e).test(t)))||o},isUrlOnList:(e,t)=>!!Array.isArray(e)&&e.some((e=>t.includes(e))),removeStoresFromRememberList:async function(e){if(!e||!this.isLastStoreTab(e))return;let t=await this.getSlug(e.url);Ro("db").get("remember",(e=>{if(!e.exist)return;let n=e.data.remember,r=[];for(let o in e.data.remember)r=e.data.remember[o],Array.isArray(r)&&r.includes(t)&&(r.splice(r.indexOf(t),1),n[o]=r);Ro("db").add("remember",n)}))},showModalErrorCashback:async function(e,t){this.cancelCashback(e,t,{data:{category:"EARLY_ACTIVATION_CASHBACK",title:"Cashback não ativado",description:"Ocorreu um erro e não conseguimos ativar o seu cashback, tente novamente.",featureName:"EARLY_ACTIVATION_CASHBACK",featureClick:"EARLY_ACTIVATION_CASHBACK",button:{trackingAction:"click",activeCashback:!0,text:"Ativar cashback",value:"EARLY_ACTIVATION_CASHBACK"},tracking:{categoryEvent:"EARLY_ACTIVATION_CASHBACK",categoryBI:"EARLY_ACTIVATION_CASHBACK"}}})},mountTabConfig:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{targetUrl:null,slug:null,featureClick:null,user:null,activeCashback:!1,redirectToNewTab:!1,redirectPath:""};const{targetUrl:t,slug:n,featureClick:r,user:o,activeCashback:i,redirectToNewTab:a,redirectPath:s}=e,c=await Ro("isFeatureEnabledInStore")("redirect-to-new-tab-on-the-same-page",n);let u="";if(await Ro("isFeatureEnabled")("send-cashback-displayed")){const{store:e}=await Ro("CuponomiaRestClient").getDataStore(n);Ro("storeHasValidCashback")(e)&&(u=`&cashbackDisplayed=${encodeURIComponent(Ro("formatCashback")(e.cashback))}`)}return{active:a||!o&&i,pinned:!a&&(!!o||!i),url:`${t}?emsid=${await Ro("eventHelper").getMastersessionID()}&feature_click=${r}${u}${o||!i?a?"":"&view=false":"#cadastro-pedagio"}${s&&c?`&redirect=${encodeURIComponent(s)}`:""}`}},dropCookieFromTargetUrl:async function(e,t,n,r,o){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"";const c=await this.mountTabConfig({targetUrl:e,slug:t,featureClick:n,user:o,activeCashback:i,redirectToNewTab:a,redirectPath:s}),u=await Ro("isFeatureEnabledInStore")("early-activation-cashback",t),l=await Ro("getFeatureConfig")("early-activation-cashback"),{activationWaitingTime:_}=l;try{return new Promise((async e=>{var n;const s=await Ro("tabHelper").createTabAsync(c),l=setTimeout((()=>{u&&(this.trackLookerEvent({evt:"EARLY_ACTIVATION_CASHBACK",action:"activation",slug:t}),e({success:!0}))}),_),d=await Ro("amazonClient").getExtensionConfig(),f=null==d||null===(n=d.activeCashbackModalRegardlessDrop)||void 0===n?void 0:n.delayToWaitForCashbackActivationInMilliseconds,h=setTimeout((async()=>{if(u){this.trackLookerEvent({evt:"EARLY_ACTIVATION_CASHBACK",action:"time_out",slug:t});const{store:e}=await Ro("CuponomiaRestClient").getDataStore(t),n=Ro("getStoreHandlerInstance")(),o=await n.getHostsBySlug({slug:t});o&&this.showModalErrorCashback(o[0],e),Ro("tabHelper").remove(s.id),Ro("tabHelper").sendMessageTab(r.id,{request:"hasDropTabClosed"})}}),f);let p=async(n,c,_)=>{if(!o&&i){if(!await Ro("userHelper").getUserInfo())return}const d=Ro("getStoreHandlerInstance")(),f=await d.getStoreByUrl({currentUrl:_.url}),g=_.id===s.id,m="complete"===c.status;if(g&&m&&f){if(Ro("tabHelper").setTitleFaviconLoadingTab(s.id),clearTimeout(l),clearTimeout(h),i)if(a)this.updateAllStoresTabsWithoutRemoveDropped(t,o,_,r,s,e);else{const{delayTimeBeforeCloseTab:n}=await Ro("amazonClient").getExtensionConfig();setTimeout((()=>{u&&this.trackLookerEvent({evt:"EARLY_ACTIVATION_CASHBACK",action:"complete_success",slug:t}),this.updateAllStoresTabs(t,o,_,r,s,e)}),n)}else Ro("tabHelper").remove(s.id),Ro("tabHelper").sendMessageTab(r.id,{request:"hasDropTabClosed"}),chrome.tabs.onUpdated.removeListener(p),e({success:!0});chrome.tabs.onUpdated.removeListener(p)}};chrome.tabs.onUpdated.addListener(p)}))}catch(e){console.warn(e),u&&this.trackLookerEvent({evt:"EARLY_ACTIVATION_CASHBACK",action:"complete_error",slug:t})}},getAllCuponomiaCookies:function(){var e=[];let t={domain:new URL("https://www.cuponomia.com.br/").host};return new Promise(((n,r)=>{chrome.cookies.getAll(t,(t=>{t.forEach((t=>{this.isJsonString(t.value)||(e[t.name]=t.value)})),n(e)}))}))},currentCampaignData:async function(){return await new Promise((async(e,t)=>{var n;const r=await Ro("db").getSession("referral_campaign"),o=(new Date).getTime(),i=new Date(null==r||null===(n=r.value)||void 0===n?void 0:n.endDate).getTime();if((null==r?void 0:r.expiresAt)>o&&i>o)return e(r.value);try{const t=await Ro("CuponomiaRestClient").getDataCampaign();return await Ro("db").addSession("referral_campaign",t,await this.getCache("referral-campaign")),e(t)}catch(e){0}}))},idGenerator:function(){const e="abcdefghijklmnopqrstuvwxyz0123456789";return Array.from({length:20},(()=>e[Math.floor(36*Math.random())])).join("")},ensureUserCookies:async function(){return{edid:await this.findOrCreate("edid"),euid:await this.findOrCreate("euid")}},findOrCreate:function(e){const t=this.idGenerator().length,n={edid:{get:(e,t)=>Ro("db").get(e,t),add:e=>Ro("db").add("edid",e,(e=>e.data))},euid:{get:(e,t)=>Ro("db").getSync(e,t),add:e=>Ro("db").addSync("euid",e,(e=>e.data))}};return new Promise((r=>n[e].get(e,(async o=>{let i=o.data&&o.data[e]||null;if(!i||i.length!==t){let t=this.idGenerator();return await n[e].add(t),r(t)}r(i)}))))},objectToQueryString:function(e){return Object.keys(e).map((t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t]))).join("&")},removeActivatedCashbacks:async function(){let e=await Ro("db").getAll();for(let t of e)t.startsWith("cashback_activated_")&&Ro("db").remove(t)},removeActivatedCashbackByTab:async function(e){if(!e||!this.isLastStoreTab(e))return;let t=n.g.clickOutTabsId.indexOf(e.id);if(t>-1)return this.removeArrayElementByIndex(n.g.clickOutTabsId,t);let r=await this.getSlug(e.url);Ro("db").remove(`cashback_activated_${r}`)},removeArrayElementByIndex:function(e,t){return e.splice(t,1)},isLastStoreTab:function(e){let t=0;if(null==e)return!1;for(let r in n.g.openedTabs)n.g.openedTabs[r].slug===e.slug&&t++;return 1===t},isLastActitiveCashbackStoreTab:async function(){const e=Ro("getStoreHandlerInstance")(),t=await chrome.storage.local.get().then((e=>Object.keys(e).filter((e=>e.startsWith("cashback_activated"))).map((t=>e[t].value.slug))));for(let n of t){const[t,r]=await Promise.all([e.getStoreBySlug({slug:n}),e.getHostsBySlug({slug:n})]);if(!t)continue;const o=(null==r?void 0:r.map((e=>`*://*.${e}/*`)))??[];if(!(await chrome.tabs.query({url:o})).length)return t.slug}return!1},isJsonString:function(e){try{JSON.parse(e)}catch(e){return!1}return!0},disableExtension:function(e){chrome.action.setIcon({path:"assets/img/icons/idle-icon.png",tabId:e})},enableStaticIcon:function(e){chrome.action.setIcon({path:"assets/img/icons/main-icon.png",tabId:e})},minutesPerMilliseconds:function(e){return e/6e4},millisecondsPerMinutes:function(e){return 6e4*e},millisecondsPerHours:function(e){return 60*e*6e4},millisecondsPerDays:function(e){return 24*e*60*6e4},millisecondsPerMonths:function(e){return 30*e*24*60*6e4},hasStoreBar:async function(){let e=await Ro("tabHelper").getCurrentTabAsync();return!(null==e||!e.id)&&await chrome.tabs.sendMessage(e.id,{text:"has_store_bar"})},getEdid:async function(){return await new Promise((e=>Ro("db").get("edid",(t=>{var n;return e(null===(n=t.data)||void 0===n?void 0:n.edid)}))))},getCurrentUrlFromRequest:function(e){var t,n,r,o,i,a,s,c;return null!==(t=e.body)&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&n.url?e.body.data.url:null!==(r=e.body)&&void 0!==r&&null!==(o=r.data)&&void 0!==o&&null!==(i=o.location)&&void 0!==i&&i.href?e.body.data.location.href:null!==(a=e.sender)&&void 0!==a&&null!==(s=a.tab)&&void 0!==s&&s.url?e.sender.tab.url:null!==(c=e.sender)&&void 0!==c&&c.url?e.sender.url:void 0},getCache:async function(e){const t=await Ro("amazonClient").getExtensionConfig();if(null==t||!t.cacheTimers||!(e in t.cacheTimers))return 36e5;return this.millisecondsPerMinutes(t.cacheTimers[e])},getCookies:async function(e,t){return new Promise(((n,r)=>{chrome.cookies.getAll(t).then((t=>{const r=t.filter((t=>e.includes(t.name))).reduce(((e,t)=>(e[t.name]=t.value,e)),{});n(r)}))}))},checkIsPinned:async function(){return(await chrome.action.getUserSettings()).isOnToolbar},cancelCashback:async function(e,t,n){e&&t&&Ro("tabHelper").executeInAllTabs({url:[`*://${e}/*`,`*://www.${e}/*`]},(e=>{Ro("tabHelper").sendMessage(e.id,"openModalAlertCashbackCancelled",n),chrome.action.setIcon({path:"assets/img/icons/main-icon.png",tabId:e.id})}))},refreshStorePages:async function(){Ro("tabHelper").query({},(async e=>{const t=Ro("getStoreHandlerInstance")();let n=(await Promise.all(e.map((async e=>await t.getStoreByUrl({currentUrl:e.url})&&e)))).filter((e=>null!==e));for(let e of n)Ro("tabHelper").reloadTab(e.id);let r=e.filter((e=>!n.includes(e))).concat(n.filter((t=>!e.includes(t))));for(let e of r)this.disableExtension(e.id)}))},setActivatedCashback:async function(e,t){var n;const r=Ro("getStoreHandlerInstance")();let[o,i,a]=await Promise.all([this.getCache("cashback-activated"),r.getStoreBySlug({slug:e.slug}),Ro("isFeatureEnabled")("expired-cashback")]);var s;Number.isFinite(null==i||null===(n=i.extensionConfiguration)||void 0===n?void 0:n.expiredCashbackTimeInMinutes)&&(o=this.millisecondsPerMinutes(null==i||null===(s=i.extensionConfiguration)||void 0===s?void 0:s.expiredCashbackTimeInMinutes));const c=(o+3e3)/6e4,u=new URL(e.tab.url).hostname;Ro("db").remove("competitor_accessed"),Ro("db").remove(`cashback_activated_toll_${e.slug}`);const l={slug:e.slug,user:e.user,blockTabs:(null==e?void 0:e.blockTabs)??[]};Ro("db").addCache(`cashback_activated_${e.slug}`,l,o).then((e=>{var n;return e.status?(!a||null!=i&&null!==(n=i.extensionConfiguration)&&void 0!==n&&n.disableExpiredCashback||chrome.alarms.create(`cashback_expired_${u}`,{delayInMinutes:c}),t({success:!0,message:"Cashback ativado!"})):t({success:!1,message:"O cashback não foi ativado!"})}))},updateAllStoresTabsWithoutRemoveDropped:async function(e,t,n,r,o,i){this.setActivatedCashback({slug:e,user:t,tab:n,blockTabs:[r.id]},(async()=>{const e=new(Ro("ForegroundHelper"));return await e.waitForReady({tabId:o.id}),Ro("tabHelper").sendMessageTab(o.id,{request:"openModalCashbackInfo",data:{title:"O seu cashback está aqui!",description:"Para garantir seu cashback, finalize sua compra <strong>apenas nesta página.</strong>",actionCopy:"Ok, entendi!",origin:"redirectToNewTab",illustrationName:"woman-cashback-success.svg",activeCashback:!1,tracking:null,featureClick:"redirect_to_new_tab",position:"topRight"}}),Ro("tabHelper").sendMessageTab(r.id,{request:"hasDropTabClosed"}),i({success:!0})}))},updateAllStoresTabs:async function(e,t,n,r,o,i){if(!await Ro("userHelper").getUserInfo())return Ro("tabHelper").remove(o.id),Ro("tabHelper").sendMessageTab(r.id,{request:"hasDropTabClosed"}),i({success:!1});this.setActivatedCashback({slug:e,user:t,tab:n},(async()=>{const t=Ro("getStoreHandlerInstance")();let n=(await t.getHostsBySlug({slug:e}))[0];r&&(n=new URL(r.url).hostname),Ro("tabHelper").remove(o.id),Ro("tabHelper").sendMessageTab(r.id,{request:"hasDropTabClosed"}),Ro("tabHelper").executeInAllTabs({url:`*://*.${n}/*`},(e=>{(null==r?void 0:r.id)!==e.id&&Ro("tabHelper").sendMessageTab(e.id,{request:"spaUpdated"})})),i({success:!0})}))},async showPinTutorial(e,t,n){e||(e=await Ro("tabHelper").getCurrentTabAsync().then((e=>e.id))),Ro("tabHelper").executeScriptFile(e,"pin_tutorial.js",(()=>chrome.tabs.sendMessage(e,{tutorial:!0,shouldShowCloseButton:t,eventOrigin:n})))},getWarningByURL:async e=>(await Ro("amazonClient").getWarnings()).find((t=>new RegExp(t.url).test(e))),getWarningById:async e=>(await Ro("amazonClient").getWarnings()).find((t=>t.id===e)),setStoreHasInteraction(e){if(!e)return;const t={...e.value,hasInteracted:!0},n=`cache_${t.slug}`,r=e.timeToExpire;Ro("db").set(n,t,r)},setStoreProp(e,t){if(!e)return;const n={...e.value,[t.prop]:t.value},r=`cache_${n.slug}`,o=e.timeToExpire;Ro("db").set(r,n,o)},setStoreCustomActivedDescription(e,t){if(!e)return;const n={...e.value,customActivedDescription:t},r=`cache_${n.slug}`,o=e.timeToExpire;Ro("db").set(r,n,o)},filterStoresbyCashback:e=>e.filter((e=>Ro("storeHasValidCashback")(e))),async setStoreHasVisited(e){if(!e)return;const t=`cache_${e}`,n=await Ro("db").getValid(t),r=n.timeToExpire,o={...n.value,hasVisited:!0,lastAccess:Date.now()};Ro("db").set(t,o,r)},removeProtocolsFromUrl:e=>e.replace(/^(?:https?:\/\/)?(?:www\.)?/i,""),handleGetCookie:async e=>e&&e.name&&e.url?new Promise((t=>{chrome.cookies.get(e,(e=>t(e)))})):null,async hasValidCashbackPageCookie(e){var t,n,r;let{cashbackPage:o,currentHost:i,cookies:a}=e;if(null==o||null===(t=o.cookieToVerify)||void 0===t||!t.name||null==o||null===(n=o.cookieToVerify)||void 0===n||!n.value)return!1;const s=a.some((e=>{var t;return(null==e?void 0:e.value)===(null===(t=o.cookieToVerify)||void 0===t?void 0:t.value)})),c=null===(r=o.unreferencedRoutes)||void 0===r?void 0:r.some((e=>{const t=this.removeProtocolsFromUrl(i),n=this.removeProtocolsFromUrl(e);return t.includes(n)}));return s&&c},async getThankYouStore(e){let{slug:t}=e;if(!t)return null;const n=(await Ro("amazonClient").getThankYouStores()).find((e=>e.slug===t));return n??null},async isCashbackPageCompetitor(e){if(["cashbackPage","currentUrl","tab"].some((t=>!e[t])))return!1;const[t,n]=await Promise.all([this.isOnCashbackPage(e.cashbackPage,e.currentUrl),this.checkBlacklist(e.tab)]),r=null==n?void 0:n.isBlacklist,o=e.cashbackPage.unreferencedRoutes.some((t=>e.currentUrl.includes(t)));return e.cashbackPage&&!t&&(r||o)},getSetting:async e=>(await Ro("amazonClient").getExtensionConfig())[e],generateHash(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;return Math.random().toString(36).substring(2,e)},async waitDelay(e){await new Promise((t=>setTimeout((()=>t()),e??0)))},async getCompetitorsOverlapTime(){const[e,t]=await Promise.all([Ro("db").getCache("installed_extensions"),Ro("getFeatureConfig")("competitors-toasts-overlap")]);if(!e||!t||!t.enabled)return 0;return e.some((e=>t.competitors.includes(e)))&&Number(t.waitTimeInMilliseconds)||0},async getDelayTimeAfterCreateTab(){const{delayTimeAfterCreateTab:e=0}=await Ro("amazonClient").getExtensionConfig(),t=await this.getCompetitorsOverlapTime();return Number(t)+Number(e)},async getTimeToTryCompetitorsTopVisibility(){const e=await Ro("getFeatureConfig")("competitors-toasts-overlap");return e&&e.enabled?e.timeToTryTopVisibilityInMilliseconds??0:0},async hasCompetitorsToOverlapInstalled(){const[e,t]=await Promise.all([Ro("db").getCache("installed_extensions"),Ro("getFeatureConfig")("competitors-toasts-overlap")]);if(!e||!t||!t.enabled)return!1;return e.some((e=>t.competitors.includes(e)))},getRootWrapperNameHash:async()=>new Promise((e=>{Ro("db").get("root-wrapper-name-hash",(t=>{var n;if(!t.exist)return null;e((null===(n=t.data)||void 0===n?void 0:n["root-wrapper-name-hash"])??null)}))})),async hasCompetitorsToBlockCashbackActivation(){const[e,t]=await Promise.all([Ro("db").getCache("installed_extensions"),Ro("getFeatureConfig")("cancel-cashback-activation-adblocker")]);if(!e||!t||!t.enabled)return!1;return e.some((e=>t.competitors.includes(e)))},sendBrowserIconEvent(){this.trackLookerEvent({evt:"BROWSER_ICON",action:"extension_not_loaded"})}};const po=ho;function go(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var mo=null;function bo(){if(null===mo){let e=go();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),mo=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return mo}function vo(){let e=go();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Eo(){let e=bo(),t=vo(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=go();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var yo="__INTENTIONAL_UNDEFINED__";let wo={};function Ro(e){let t=Eo();if(void 0===t[e])return function(e){switch(e){case"useCashback":return Fe;case"amazonClient":return J;case"db":return b;case"getStoreHandlerInstance":return Jr;case"userHelper":return br;case"eventHelper":return on;case"eventsClient":return he;case"development":return fo;case"isFeatureDisabledInStore":return nt;case"formatCashback":return lo;case"CuponomiaRestClient":return rr;case"isFeatureEnabledInStore":return tt;case"isFeatureEnabled":return et;case"storeHasValidCashback":return _o;case"getFeatureConfig":return rt;case"tabHelper":return r;case"ForegroundHelper":return Mr}return}(e);var n=t[e];return n===yo?void 0:n}function To(e,t){let n=Eo();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){Oo(e)}))}):(n[e]=void 0===t?yo:t,function(){Oo(e)})}function Oo(e){let t=Eo();delete t[e],0==Object.keys(t).length&&delete vo()[bo]}function Co(e){let t=Eo();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(wo,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",Ro),e("__GetDependency__",Ro),e("__Rewire__",To),e("__set__",To),e("__reset__",Oo),e("__ResetDependency__",Oo),e("__with__",Co)}();function Io(e,t){Object.defineProperty(ho,e,{value:t,enumerable:!1,configurable:!0})}Object.isExtensible(ho)&&(Io("__get__",Ro),Io("__GetDependency__",Ro),Io("__Rewire__",To),Io("__set__",To),Io("__reset__",Oo),Io("__ResetDependency__",Oo),Io("__with__",Co),Io("__RewireAPI__",wo));let Lo={injectContentScripts:async function(e,t,n){if(!e)return;e=[].concat(e);let r=[];for(let o of e){const e=`${o.includes("/")?"stores":t}/${o}`;if(o.includes("similar-products")){if(!(await xo("userHelper").getUserPreferences()).hasPreference("similar-products"))continue}r.push(xo("tabHelper").executeContentScript(n,e))}await Promise.all(r)}};function So(e){if(!e)return!1;const t=window.getComputedStyle(e);return!("none"===t.display||"hidden"===t.visibility||null===e.offsetParent)}function Ao(e,t){const n=document.querySelector(t);return n?e&&xo("isElementVisible")(n):e&&!1}function ko(e,t){let n;return function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];n&&clearTimeout(n),n=setTimeout((()=>{e(...o),n=null}),t)}}async function Do(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e4;return new Promise((n=>{const r=setTimeout((()=>{o.disconnect(),n()}),t);if(document.querySelector(e))return clearTimeout(r),n(document.querySelector(e));const o=new MutationObserver((()=>{if(document.querySelector(e))return clearTimeout(r),o.disconnect(),n(document.querySelector(e))}));o.observe(document.body,{childList:!0,subtree:!0})}))}function Mo(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var $o=null;function Po(){if(null===$o){let e=Mo();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),$o=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return $o}function jo(){let e=Mo();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Bo(){let e=Po(),t=jo(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=Mo();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Go="__INTENTIONAL_UNDEFINED__";let No={};function xo(e){let t=Bo();if(void 0===t[e])return function(e){switch(e){case"isElementVisible":return So;case"generalHelper":return po;case"waitForHTMLElement":return Do;case"userHelper":return br;case"tabHelper":return r}return}(e);var n=t[e];return n===Go?void 0:n}function Uo(e,t){let n=Bo();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){Fo(e)}))}):(n[e]=void 0===t?Go:t,function(){Fo(e)})}function Fo(e){let t=Bo();delete t[e],0==Object.keys(t).length&&delete jo()[Po]}function Wo(e){let t=Bo();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(No,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",xo),e("__GetDependency__",xo),e("__Rewire__",Uo),e("__set__",Uo),e("__reset__",Fo),e("__ResetDependency__",Fo),e("__with__",Wo)}();function Ho(e,t){Object.defineProperty(Lo,e,{value:t,enumerable:!1,configurable:!0})}Object.isExtensible(Lo)&&(Ho("__get__",xo),Ho("__GetDependency__",xo),Ho("__Rewire__",Uo),Ho("__set__",Uo),Ho("__reset__",Fo),Ho("__ResetDependency__",Fo),Ho("__with__",Wo),Ho("__RewireAPI__",No));class Vo{constructor(){}captureException(e){throw new Error("captureException method must be overridden.")}}class Yo extends(ei("ErrorManager")){constructor(){super()}captureException(e){console.error(e)}}function qo(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var Xo=null;function zo(){if(null===Xo){let e=qo();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),Xo=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return Xo}function Qo(){let e=qo();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Ko(){let e=zo(),t=Qo(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=qo();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Jo="__INTENTIONAL_UNDEFINED__";let Zo={};function ei(e){let t=Ko();if(void 0===t[e])return function(e){if("ErrorManager"===e)return Vo;return}(e);var n=t[e];return n===Jo?void 0:n}function ti(e,t){let n=Ko();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){ni(e)}))}):(n[e]=void 0===t?Jo:t,function(){ni(e)})}function ni(e){let t=Ko();delete t[e],0==Object.keys(t).length&&delete Qo()[zo]}function ri(e){let t=Ko();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(Zo,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",ei),e("__GetDependency__",ei),e("__Rewire__",ti),e("__set__",ti),e("__reset__",ni),e("__ResetDependency__",ni),e("__with__",ri)}();let oi=typeof Yo;function ii(e,t){Object.defineProperty(Yo,e,{value:t,enumerable:!1,configurable:!0})}"object"!==oi&&"function"!==oi||!Object.isExtensible(Yo)||(ii("__get__",ei),ii("__GetDependency__",ei),ii("__Rewire__",ti),ii("__set__",ti),ii("__reset__",ni),ii("__ResetDependency__",ni),ii("__with__",ri),ii("__RewireAPI__",Zo));const ai=async()=>new(pi("ConsoleErrorManager")),si=async e=>{(await pi("getErrorManager")()).captureException(new Error(e))};function ci(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var ui=null;function li(){if(null===ui){let e=ci();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),ui=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return ui}function _i(){let e=ci();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function di(){let e=li(),t=_i(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=ci();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var fi="__INTENTIONAL_UNDEFINED__";let hi={};function pi(e){let t=di();if(void 0===t[e])return function(e){switch(e){case"ConsoleErrorManager":return Yo;case"getErrorManager":return ai}return}(e);var n=t[e];return n===fi?void 0:n}function gi(e,t){let n=di();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){mi(e)}))}):(n[e]=void 0===t?fi:t,function(){mi(e)})}function mi(e){let t=di();delete t[e],0==Object.keys(t).length&&delete _i()[li]}function bi(e){let t=di();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(hi,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",pi),e("__GetDependency__",pi),e("__Rewire__",gi),e("__set__",gi),e("__reset__",mi),e("__ResetDependency__",mi),e("__with__",bi)}();const vi=new(Li("LocalStorage"));class Ei{constructor(e){var t;this.canInitialize=!0,this.elementsToQuery=e.selectors,this.dynamicElements=e.dynamicElements?e.dynamicElements:[],this.storeSlug=e.slug,this.useXpathSelector=null==e?void 0:e.useXpathSelector,Object.keys(this.elementsToQuery).forEach((e=>{if(this.shouldLogError(e)){const t=this.elementsToQuery[e];this.gaSendEvent(t,"coupon_tester_elemento_nao_encontrado"),this.handleErrorManual(t),this.canInitialize=!1}})),this.submitCouponCode=this.getHTMLObject(this.elementsToQuery.submit),this.couponInput=this.getHTMLObject(this.elementsToQuery.input),this.totalValueElement=this.getHTMLObject(this.elementsToQuery.total),this.clearCoupon=this.getHTMLObject(null===(t=this.elementsToQuery)||void 0===t?void 0:t.clear),this.preValidCouponCodes=[],this.preTestedCouponCodes=[],this.couponResultsApi=e.couponResultsApi,this.clearValidCouponButtonSelector=this.elementsToQuery.clearValidCouponButton,this.genericTestDisabled=null==e?void 0:e.genericTestDisabled,this.waitTimeIfHasOneCoupon=e.waitTimeIfHasOneCoupon?parseInt(e.waitTimeIfHasOneCoupon):0,this.waitTimeBetweenCoupons=e.waitTimeBetweenCoupons?parseInt(e.waitTimeBetweenCoupons):0,this.WAITING_TIME_LIMIT=3e4,this.testOnlyOneTime=e.testOnlyOneTime}shouldLogError(e){return!this.dynamicElements.includes(e)&&!this.getHTMLObject(this.elementsToQuery[e])}gaSendEvent(e,t){chrome.runtime.sendMessage({action:"gaSendEvent",data:{category:t,action:e,label:this.storeSlug,nonInteraction:!0}})}handleErrorManual(e){const t=`Element not found "${e}"`;Li("sendErrorMessage")(t)}handleError(e){const t={action:"error",error:e.message?e.message:e,store:this.storeSlug,variation:"coupon_tester"};chrome.runtime.sendMessage({action:"lookerSendEvent",data:{evt:"CART_FEATURES",...t}}),document.dispatchEvent(new CustomEvent("cancelCuponomiaCouponTester")),chrome.runtime.sendMessage({action:"finishTestingCoupons",data:{}})}getHTMLObject(e){return this.useXpathSelector?this.getElementByXPath(e):document.querySelector(e)}getElementByXPath(e){return(new XPathEvaluator).createExpression(e).evaluate(document,XPathResult.FIRST_ORDERED_NODE_TYPE).singleNodeValue}initializeCouponTester(){this.canInitialize&&(this.testingCancelled=!1,chrome.runtime.sendMessage({action:"canInitCouponTester",data:{isCouponPage:!0}}),chrome.runtime.sendMessage({action:"showCartModal"}),document.addEventListener("startCuponomiaCouponTester",(e=>{this.testingCancelled=!1,this.testCouponCodes(e.detail.codes)})),document.addEventListener("cancelCuponomiaCouponTester",(()=>this.testingCancelled=!0)))}initializeGenericCouponTester(){const e=this;return new Promise((t=>{chrome.runtime.sendMessage({action:"canInitGenericTester"}),document.addEventListener("cuponomiaInitGenericTester",(function n(r){if(!r.detail.canInit)return t();chrome.runtime.sendMessage({action:"startGenericCouponTester",data:{}}),document.removeEventListener("cuponomiaInitGenericTester",n),document.addEventListener("startCuponomiaGenericCouponTester",(function n(r){this.testingCancelled=!1,document.dispatchEvent(new CustomEvent("cuponomiaTestingGenericCoupons",{detail:r.detail.codes})),document.removeEventListener("startCuponomiaGenericCouponTester",n),t(e.testGenericCoupons(r.detail.codes))}))}))}))}formatCouponCode(e,t){return e.replace("[SLUG]",t).replaceAll("-","")}async testGenericCoupons(e){let t=[],n={};n.originalTotal=Number((await this.getOriginalTotalValue()).toFixed(2));for(let r in e){let o=e[r].includes("[SLUG]")?this.formatCouponCode(e[r],this.storeSlug).toUpperCase():e[r];if(this.testingCancelled)return{cancelled:!0};await this.insertCouponCode(o),document.dispatchEvent(new CustomEvent("cuponomiaCurrentCodeGeneric",{detail:r})),await this.waitLoadingButton();const i=this.getCurrentTotalValue();if(i<n.originalTotal&&(t.push({code:o,totalValue:i}),this.clearValidCouponButtonSelector)){let e=document.querySelector(this.clearValidCouponButtonSelector);e&&e.click()}this.waitTimeBetweenCoupons&&await new Promise((e=>setTimeout((()=>e()),this.waitTimeBetweenCoupons)))}this.sendCouponsResultToApi(e,t,!0);let r=this.getBestCouponCode(t);return r?(await this.insertCouponCode(r.code),n.validCoupon={...r}):await this.clearCouponInput(),n}async testCouponCodes(e){try{let t=[],n={};this.couponAlreadyApplied=this.verifyExistingValidCoupon(),n.originalTotal=Number((await this.getOriginalTotalValue()).toFixed(2));for(let r in e){if(this.testingCancelled)return{cancelled:!0};await this.insertCouponCode(e[r]),document.dispatchEvent(new CustomEvent("cuponomiaCurrentCode",{detail:r})),await this.waitLoadingButton();const o=this.getCurrentTotalValue();if(o<n.originalTotal&&(t.push({code:e[r],totalValue:o}),this.clearValidCouponButtonSelector)){let e=document.querySelector(this.clearValidCouponButtonSelector);e&&e.click()}this.waitTimeBetweenCoupons&&await new Promise((e=>setTimeout((()=>e()),this.waitTimeBetweenCoupons)))}this.couponAlreadyApplied&&t.push(this.couponAlreadyApplied),this.sendCouponsResultToApi(e,t,this.genericTestDisabled);let r=this.getBestCouponCode(t);r?(await this.insertCouponCode(r.code),n.validCoupon={...r}):this.genericTestDisabled?await this.clearCouponInput():n=await this.initializeGenericCouponTester(),chrome.runtime.sendMessage({action:"finishTestingCoupons",data:{...n}}),this.testOnlyOneTime&&chrome.runtime.sendMessage({action:"canInitCouponTester",data:{isCouponPage:!1}})}catch(e){this.handleError(e)}}async clearCouponInput(){if(this.clearCoupon)return this.clearCoupon.click(),await this.waitLoadingButton(),!0}getDiscount(){const e=this.getHTMLObject(this.elementsToQuery.validCoupon);return!!(null==e?void 0:e.textContent.includes("Descontos"))||null}verifyExistingValidCoupon(){if(!this.getDiscount())return null;const e=this.getCurrentTotalValue();return{code:this.couponInput.value,totalValue:e}}async getOriginalTotalValue(){const e=this.getHTMLObject(this.elementsToQuery.clear);return e&&e.click(),await new Promise((e=>setTimeout((()=>e()),3e3))),this.getCurrentTotalValue()}getCurrentTotalValue(){var e;const t=this.getHTMLObject(this.elementsToQuery.total);return Number((null===(e=t.textContent.match(/\d+/g))||void 0===e?void 0:e.join(""))??0)/100}getBestCouponCode(e){let t=Math.min.apply(Math,e.map((e=>e.totalValue)));return e.find((e=>e.totalValue===t))}sendCouponsResultToApi(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=e.map((e=>e.replaceAll("[SLUG]",this.storeSlug.toUpperCase()).replaceAll("-",""))),o=[...this.preValidCouponCodes,...t].filter(((e,t,n)=>t===n.findIndex((t=>t.code===e.code)))).map((e=>e.code)),i=[...this.preTestedCouponCodes,...r].filter((e=>!o.includes(e)));o.length||n?(this.preValidCouponCodes=[],this.preTestedCouponCodes=[],chrome.runtime.sendMessage({action:"dbGet",data:{key:"coupon_results"}},(async e=>{let{data:t}=e;const n=(null==t?void 0:t.coupon_results)??{},r=n[this.storeSlug],a=new Date,s=(e,t)=>{if(e.length!==t.length)return!1;const n=new Set([...e,...t]);for(const r of n){if(e.filter((e=>e===r)).length!==t.filter((e=>e===r)).length)return!1}return!0};if(!r||a>new Date(r.date).addDays(1)||!s(r.workingCoupons,o)&&!s(r.notWorkingCoupons,i)){const e=new Date,t=await Li("generalHelper").getEdid(),r={store:this.storeSlug,workingCoupons:o,notWorkingCoupons:i,date:e};n[this.storeSlug]={workingCoupons:o,notWorkingCoupons:i,date:e},Li("localStorage").add({key:"coupon_results",value:n}),fetch(this.couponResultsApi,{method:"post",body:JSON.stringify({...r,edid:t})})}}))):(this.preValidCouponCodes=t,this.preTestedCouponCodes=e)}initSPAHistoryListener(e){let{queriesToVerify:t}=e;if(void 0===t||0===t.length)throw new Error("SPA LISTENER: Visibility Queries not found");window.$cpnSPAListener||chrome.runtime.onMessage.addListener((function(e,n,r){if("spaUpdated"===e.request){const e=t.reduce(Li("elementVisibilityReducer"),!0);chrome.runtime.sendMessage({action:"canInitCouponTester",data:{isCouponPage:e}}),e&&(document.addEventListener("startCuponomiaCouponTester",(e=>{this.testingCancelled=!1,this.testCouponCodes(e.detail.codes)})),document.addEventListener("cancelCuponomiaCouponTester",(()=>this.testingCancelled=!0)))}})),window.$cpnSPAListener=!0}initInMemoryListener(e){let{routes:t,elementsToUpdateCallback:n}=e;if(void 0===t||0===t.length)throw new Error("INMEMORY LISTENER: Route Queries not found");function r(){return t.find((e=>{const t=document.querySelector(e.selector);return Li("isElementVisible")(t)}))}let o=!0,i=r();window.addEventListener("mousemove",Li("debounce")((()=>{n();const e=r();i.name!==e.name&&(o&&e.hasCouponInput&&(this.initializeCouponTester(),chrome.runtime.sendMessage({action:"showCartModal"}),o=!1),chrome.runtime.sendMessage({action:"canInitCouponTester",data:{isCouponPage:e.hasCouponInput}}),i=e)}),150))}async waitForHTMLElement(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.WAITING_TIME_LIMIT;return new Promise((n=>{const r=setTimeout((()=>{o.disconnect(),n()}),t);if(document.querySelector(e))return clearTimeout(r),n(document.querySelector(e));const o=new MutationObserver((()=>{if(document.querySelector(e))return clearTimeout(r),o.disconnect(),n(document.querySelector(e))}));o.observe(document.body,{childList:!0,subtree:!0})}))}async removeHTMLElement(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.WAITING_TIME_LIMIT;const n=await this.waitForHTMLElement(e,t);null==n||n.remove()}hasSpecialCharacter(e){return/[ `!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?~]/.test(e)}findCouponIndex(e,t){const n=e.findIndex((e=>t.toLowerCase()===e.toLowerCase()));return-1===n?null:n}async waitDelay(e){await new Promise((t=>setTimeout((()=>t()),e??0)))}async waitTimeBetweenCouponTests(){this.waitTimeBetweenCoupons&&await new Promise((e=>setTimeout((()=>e()),this.waitTimeBetweenCoupons)))}}function yi(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var wi=null;function Ri(){if(null===wi){let e=yi();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),wi=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return wi}function Ti(){let e=yi();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Oi(){let e=Ri(),t=Ti(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=yi();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Ci="__INTENTIONAL_UNDEFINED__";let Ii={};function Li(e){let t=Oi();if(void 0===t[e])return function(e){switch(e){case"LocalStorage":return An;case"sendErrorMessage":return si;case"generalHelper":return po;case"localStorage":return vi;case"elementVisibilityReducer":return Ao;case"isElementVisible":return So;case"debounce":return ko}return}(e);var n=t[e];return n===Ci?void 0:n}function Si(e,t){let n=Oi();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){Ai(e)}))}):(n[e]=void 0===t?Ci:t,function(){Ai(e)})}function Ai(e){let t=Oi();delete t[e],0==Object.keys(t).length&&delete Ti()[Ri]}function ki(e){let t=Oi();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(Ii,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",Li),e("__GetDependency__",Li),e("__Rewire__",Si),e("__set__",Si),e("__reset__",Ai),e("__ResetDependency__",Ai),e("__with__",ki)}();let Di=typeof Ei;function Mi(e,t){Object.defineProperty(Ei,e,{value:t,enumerable:!1,configurable:!0})}"object"!==Di&&"function"!==Di||!Object.isExtensible(Ei)||(Mi("__get__",Li),Mi("__GetDependency__",Li),Mi("__Rewire__",Si),Mi("__set__",Si),Mi("__reset__",Ai),Mi("__ResetDependency__",Ai),Mi("__with__",ki),Mi("__RewireAPI__",Ii));class $i extends(Fi("CouponTester")){constructor(e){var t;super(e),this.isReloadableTester=!0,this.storedCouponTesterData=this.getStoredCouponTesterData(),this.nodeForObserve=document.querySelector(null===(t=e.elementsToObserve)||void 0===t?void 0:t.nodeForObserve),this.loadingObserverConfig={subtree:!0,childList:!0}}getStoredCouponTesterData(){return JSON.parse(sessionStorage.getItem("couponTester"))}get isTesting(){var e;return null===(e=this.storedCouponTesterData)||void 0===e?void 0:e.isTesting}get currentCouponIndex(){var e;const t=null===(e=this.storedCouponTesterData)||void 0===e?void 0:e.currentCouponIndex;return Number.isInteger(t)&&t<this.couponCodes.length?t:null}get couponCodes(){var e;return null===(e=this.storedCouponTesterData)||void 0===e?void 0:e.couponCodes}get validCoupons(){var e;return(null===(e=this.storedCouponTesterData)||void 0===e?void 0:e.validCoupons)??[]}get bestCoupon(){var e;return null===(e=this.storedCouponTesterData)||void 0===e?void 0:e.bestCoupon}get previousInsert(){return this.storedCouponTesterData.previousInsert}get nextCouponIndex(){return Number.isInteger(this.currentCouponIndex)?this.currentCouponIndex+1:0}get originalTotal(){var e;return(null===(e=this.storedCouponTesterData)||void 0===e?void 0:e.originalTotal)??null}updateStoredCouponTesterData(e){"object"==typeof e&&(sessionStorage.setItem("couponTester",JSON.stringify(e)),this.storedCouponTesterData=this.getStoredCouponTesterData())}cleanStoredCouponTesterData(){sessionStorage.removeItem("couponTester"),this.storedCouponTesterData=this.getStoredCouponTesterData()}insertCouponCode(e){try{var t;const n=Object.getPrototypeOf(this.couponInput);Object.getOwnPropertyDescriptor(n,"value").set.call(this.couponInput,null==e?void 0:e.trim()),this.couponInput.dispatchEvent(new Event("change",{bubbles:!0})),null===(t=this.submitCouponCode)||void 0===t||t.click()}catch(e){this.cleanStoredCouponTesterData(),this.handleError(e)}}hasInitialValidCoupon(e,t){if(!this.storedCouponTesterData)return this.updateStoredCouponTesterData({isTesting:!0,validCoupons:[],currentCouponIndex:0,couponCodes:t,hasFinished:!1,bestCoupon:null,previousInsert:[],isReloadClearInput:!1,hasInitialValidCoupon:!1,originalTotal:this.originalTotal||e}),this.hasValidCoupon()}hasValidCoupon(){return!!document.querySelector(this.elementsToQuery.validCoupon)}getCoupon(){if(!this.hasValidCoupon())return null;const e=this.getCurrentTotalValue();return{code:this.couponInput.value,totalValue:e}}findBestCouponIndex(e){const t=this.storedCouponTesterData.validCoupons.findIndex((t=>t.code===e.code&&t.totalValue===e.totalValue));return-1===t?null:t}initializeCouponTester(){this.canInitialize&&(this.testingCancelled=!1,chrome.runtime.sendMessage({action:"canInitCouponTester",data:{isCouponPage:!0,isReloadableTester:this.isReloadableTester}}),chrome.runtime.sendMessage({action:"showCartModal"}),document.addEventListener("startCuponomiaCouponTester",(e=>{this.testingCancelled=!1,this.testCouponCodes(e.detail.codes)})),document.addEventListener("cancelCuponomiaCouponTester",(()=>this.testingCancelled=!0)))}async waitDelay(e){await new Promise((t=>setTimeout(t,e)))}waitLoadingButton(){const e=this;return new Promise((t=>{let n=setTimeout((()=>{r.disconnect(),t()}),this.WAITING_TIME_LIMIT);if(!e.nodeForObserve)return this.handleError("nodeForObserve not found"),clearTimeout(n),void t();const r=new MutationObserver(((e,r)=>{for(const o of e){this.hasLoadingFinished(o)&&(clearTimeout(n),r.disconnect(),t())}}));r.observe(e.nodeForObserve,this.loadingObserverConfig)}))}increaseCouponIndex(){this.updateStoredCouponTesterData({...this.storedCouponTesterData,currentCouponIndex:this.nextCouponIndex})}stopCouponInsertion(){this.updateStoredCouponTesterData({...this.storedCouponTesterData,isTesting:!1,currentCouponIndex:null})}setBestCoupon(e){let{coupon:t,couponIndex:n}=e;this.updateStoredCouponTesterData({...this.storedCouponTesterData,bestCoupon:t,currentCouponIndex:n})}}function Pi(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var ji=null;function Bi(){if(null===ji){let e=Pi();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),ji=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return ji}function Gi(){let e=Pi();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Ni(){let e=Bi(),t=Gi(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=Pi();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var xi="__INTENTIONAL_UNDEFINED__";let Ui={};function Fi(e){let t=Ni();if(void 0===t[e])return function(e){if("CouponTester"===e)return Ei;return}(e);var n=t[e];return n===xi?void 0:n}function Wi(e,t){let n=Ni();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){Hi(e)}))}):(n[e]=void 0===t?xi:t,function(){Hi(e)})}function Hi(e){let t=Ni();delete t[e],0==Object.keys(t).length&&delete Gi()[Bi]}function Vi(e){let t=Ni();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(Ui,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",Fi),e("__GetDependency__",Fi),e("__Rewire__",Wi),e("__set__",Wi),e("__reset__",Hi),e("__ResetDependency__",Hi),e("__with__",Vi)}();let Yi=typeof $i;function qi(e,t){Object.defineProperty($i,e,{value:t,enumerable:!1,configurable:!0})}"object"!==Yi&&"function"!==Yi||!Object.isExtensible($i)||(qi("__get__",Fi),qi("__GetDependency__",Fi),qi("__Rewire__",Wi),qi("__set__",Wi),qi("__reset__",Hi),qi("__ResetDependency__",Hi),qi("__with__",Vi),qi("__RewireAPI__",Ui));class Xi extends(na("ReloadableTester")){constructor(e){var t,n,r;super(e),this.loadingElement=document.querySelector(e.elementsToObserve.loadingElementClass),this.loadingAttributeName=null===(t=e.elementsToObserve)||void 0===t?void 0:t.loadingAttributeName,this.loadingDisplayValue=null===(n=e.elementsToObserve)||void 0===n?void 0:n.loadingDisplayValue,this.discountElement=null===(r=e.elementsToObserve)||void 0===r?void 0:r.discountElement,this.loadingObserverConfig={attributes:!0},this.watchReload(),this.waitForHTMLElement(this.elementsToQuery.input).then((async()=>{await this.waitDelay(3e3),this.updateElements(),this.storedCouponTesterData?(chrome.runtime.sendMessage({action:"startCouponTester",data:{slug:e.slug,currentCouponIndex:Math.min(this.currentCouponIndex,this.couponCodes.length-1)}}),this.testCouponCodes(this.couponCodes).then((()=>{this.storedCouponTesterData||this.initializeCouponTester()}))):this.initializeCouponTester()}))}watchReload(){window.addEventListener("beforeunload",(async()=>{this.isReloading=!0,this.currentCoupon&&this.updateStoredCouponTesterData({...this.storedCouponTesterData,currentCouponIndex:this.nextCouponIndex})}))}getCoupon(){if(!this.hasValidCoupon())return null;const e=document.querySelector(this.elementsToQuery.validCoupon),t=this.getCurrentTotalValue();return{code:null==e?void 0:e.textContent,totalValue:t}}updateElements(){this.submitCouponCode=document.querySelector(this.elementsToQuery.submit),this.couponInput=document.querySelector(this.elementsToQuery.input),this.validCoupon=document.querySelector(this.elementsToQuery.validCoupon),this.invalidCoupon=document.querySelector(this.elementsToQuery.invalidCoupon),this.clearCoupon=document.querySelector(this.elementsToQuery.clear),this.totalValueElement=document.querySelector(this.elementsToQuery.total),this.subtotalElement=document.querySelector(this.elementsToQuery.subtotal),this.freightElement=document.querySelector(this.elementsToQuery.freight),this.showInput=document.querySelector(this.elementsToQuery.showInput),this.discount=document.querySelector(this.elementsToQuery.discountElement)}get originalTotalValue(){var e,t;this.updateElements();const n=null===(e=this.totalValueElement)||void 0===e?void 0:e.textContent,r=(null==n||null===(t=n.match(/\d+/g))||void 0===t?void 0:t.join(""))/100;return Number.isNaN(r)?0:r}hasInitialValidCoupon(e,t){var n;if(this.storedCouponTesterData)return;const r=this.getCoupon(),o=(null==r?void 0:r.totalValue)<e,i=null!==(n=this.storedCouponTesterData)&&void 0!==n&&n.originalTotal?this.storedCouponTesterData.originalTotal:e;return this.updateStoredCouponTesterData({isTesting:!0,validCoupons:[],currentCouponIndex:0,couponCodes:t,hasFinished:!1,bestCoupon:null,originalTotal:i}),o}async testCouponCodes(e){try{if(this.getCoupon()&&!this.isTesting&&!this.bestCoupon){var t,n;const r=null===(t=this.discount)||void 0===t?void 0:t.textContent,o=(null==r||null===(n=r.match(/\d+/g))||void 0===n?void 0:n.join(""))/100;return this.clearCoupon.click(),void this.updateStoredCouponTesterData({...this.storedCouponTesterData,isTesting:!0,validCoupons:[],currentCouponIndex:0,couponCodes:e,hasFinished:!1,bestCoupon:null,originalTotal:Number(o+this.originalTotalValue)})}!this.isCouponFieldVisible&&this.showInput&&this.showInput.click();if(this.hasInitialValidCoupon(Number(this.originalTotalValue),e))return void this.clearCoupon.click();if(this.isTesting){if(this.currentCoupon=this.getCoupon(),this.currentCoupon)return this.validCoupons.push(this.currentCoupon),this.updateStoredCouponTesterData(this.storedCouponTesterData),void this.clearCoupon.click();for(const t in e){if(this.isReloading)return;if(this.testingCancelled)return{cancelled:!0};if(Number.isInteger(this.currentCouponIndex)||this.updateStoredCouponTesterData({...this.storedCouponTesterData,currentCouponIndex:Number(t)}),this.insertCouponCode(e[this.currentCouponIndex]),document.dispatchEvent(new CustomEvent("cuponomiaCurrentCode",{detail:this.currentCouponIndex})),await this.waitLoadingButton(),this.isReloading||this.updateStoredCouponTesterData({...this.storedCouponTesterData,currentCouponIndex:this.nextCouponIndex}),!this.currentCouponIndex||this.currentCouponIndex===e.length)break}if(this.isReloading)return;this.updateStoredCouponTesterData({...this.storedCouponTesterData,isTesting:!1})}if(!this.isTesting&&!this.bestCoupon){await this.waitDelay(1e3);const e=this.getBestCouponCode(this.validCoupons);if(e)return this.updateStoredCouponTesterData({...this.storedCouponTesterData,bestCoupon:e,currentCouponIndex:this.findCouponIndex(this.couponCodes,e.code)}),void this.insertCouponCode(e.code);this.insertCouponCode("")}this.sendCouponsResultToApi(e,this.validCoupons,this.genericTestDisabled),await this.waitDelay(1e3),chrome.runtime.sendMessage({action:"finishTestingCoupons",data:{validCoupon:this.bestCoupon,originalTotal:this.storedCouponTesterData.originalTotal}}),this.cleanStoredCouponTesterData()}catch(e){this.cleanStoredCouponTesterData(),this.handleError(e)}}hasLoadingFinished(e){var t;return e.attributeName===this.loadingAttributeName&&(null===(t=e.target.style)||void 0===t?void 0:t.display)===this.loadingDisplayValue}get isCouponFieldVisible(){return!!document.querySelector(this.elementsToQuery.couponFieldVisible)}insertCouponCode(e){try{var t;const n=Object.getPrototypeOf(this.couponInput);Object.getOwnPropertyDescriptor(n,"value").set.call(this.couponInput,null==e?void 0:e.trim()),this.couponInput.dispatchEvent(new Event("change",{bubbles:!0})),this.couponInput.dispatchEvent(new Event("input")),this.couponInput.dispatchEvent(new KeyboardEvent("keyup")),null===(t=this.submitCouponCode)||void 0===t||t.click()}catch(e){this.cleanStoredCouponTesterData(),this.handleError(e)}}}function zi(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}chrome.runtime.sendMessage({action:"getCouponTesterConfig",data:{slug:"hp"}},(e=>new(na("HPCouponTester"))(e)));var Qi=null;function Ki(){if(null===Qi){let e=zi();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),Qi=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return Qi}function Ji(){let e=zi();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Zi(){let e=Ki(),t=Ji(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=zi();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var ea="__INTENTIONAL_UNDEFINED__";let ta={};function na(e){let t=Zi();if(void 0===t[e])return function(e){switch(e){case"ReloadableTester":return $i;case"HPCouponTester":return Xi}return}(e);var n=t[e];return n===ea?void 0:n}function ra(e,t){let n=Zi();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){oa(e)}))}):(n[e]=void 0===t?ea:t,function(){oa(e)})}function oa(e){let t=Zi();delete t[e],0==Object.keys(t).length&&delete Ji()[Ki]}function ia(e){let t=Zi();var n=Object.keys(e),r={};function o(){n.forEach((function(e){t[e]=r[e]}))}return function(i){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let a=i();return a&&"function"==typeof a.then?a.then(o).catch(o):o(),a}}!function(){function e(e,t){Object.defineProperty(ta,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",na),e("__GetDependency__",na),e("__Rewire__",ra),e("__set__",ra),e("__reset__",oa),e("__ResetDependency__",oa),e("__with__",ia)}();let aa=typeof Xi;function sa(e,t){Object.defineProperty(Xi,e,{value:t,enumerable:!1,configurable:!0})}"object"!==aa&&"function"!==aa||!Object.isExtensible(Xi)||(sa("__get__",na),sa("__GetDependency__",na),sa("__Rewire__",ra),sa("__set__",ra),sa("__reset__",oa),sa("__ResetDependency__",oa),sa("__with__",ia),sa("__RewireAPI__",ta))})()})();